_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[59],{"/Ugf":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("rB9j"),n("UxlC");function i(e){return e.replace(/(<\/?.+?\/?>)|\n/g,"")}},JMpY:function(e,t,n){"use strict";n("sMBO");var i,a=n("nKUr"),r=n("lwsE"),s=n.n(r),o=n("W8MJ"),c=n.n(o),l=n("7W2i"),u=n.n(l),d=n("a1gu"),p=n.n(d),h=n("Nsbk"),v=n.n(h),m=n("q1tI"),f=n.n(m),j=n("MCNy"),b=n.n(j),k=n("5f2u"),x=n.n(k),C=n("Bvw4"),O=n("l/UT"),y=n("+Lwc"),D=n("yuBF"),w=n("TSYQ"),g=n.n(w);function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return p()(this,n)}}var R=Object(D.inject)("thread")(i=Object(D.observer)(i=function(e){u()(n,e);var t=N(n);function n(e){var i;return s()(this,n),(i=t.call(this,e)).user=i.props.user||{},i}return c()(n,[{key:"onFollowClick",value:function(){"function"===typeof this.props.onFollowClick&&this.props.onFollowClick()}},{key:"onPrivateLetter",value:function(){"function"===typeof this.props.onPrivateLetter&&this.props.onPrivateLetter()}},{key:"onPersonalPage",value:function(){"function"===typeof this.props.onPersonalPage&&this.props.onPersonalPage()}},{key:"render",value:function(){var e=this;return Object(a.jsxs)("div",{className:O.a.container,children:[Object(a.jsx)("div",{className:O.a.header,children:Object(a.jsx)("span",{children:"\u697c\u4e3b"})}),Object(a.jsxs)("div",{className:O.a.info,children:[Object(a.jsxs)("div",{className:O.a.AuthorInfo,children:[Object(a.jsx)("div",{className:O.a.avatar,children:Object(a.jsx)(C.a,{image:this.user.avatarUrl,name:this.user.nickname,circle:!0,userId:this.user.id,platform:"pc",onClick:function(){return e.onPersonalPage()}})}),Object(a.jsxs)("div",{className:O.a.information,children:[Object(a.jsx)("div",{className:O.a.name,onClick:function(){return e.onPersonalPage()},children:this.user.nickname||""}),Object(a.jsxs)("div",{className:O.a.dynamic,children:["\u6d3b\u8dc3\u5728 ",Object(y.a)(this.user.updatedAt)]})]})]}),Object(a.jsxs)("div",{className:O.a.theme,children:[Object(a.jsxs)("div",{className:O.a.themeInfo,children:[Object(a.jsx)("div",{className:O.a.title,children:"\u4e3b\u9898"}),Object(a.jsx)("div",{className:O.a.number,children:this.user.threadCount})]}),Object(a.jsxs)("div",{className:O.a.themeInfo,children:[Object(a.jsx)("div",{className:O.a.title,children:"\u70b9\u8d5e"}),Object(a.jsx)("div",{className:O.a.number,children:this.user.likedCount})]}),Object(a.jsxs)("div",{className:O.a.themeInfo,children:[Object(a.jsx)("div",{className:O.a.title,children:"\u5df2\u5173\u6ce8"}),Object(a.jsx)("div",{className:O.a.number,children:this.user.followCount})]}),Object(a.jsxs)("div",{className:O.a.themeInfo,children:[Object(a.jsx)("div",{className:O.a.title,children:"\u7c89\u4e1d"}),Object(a.jsx)("div",{className:O.a.number,children:this.user.fansCount})]})]})]}),this.props.isShowBtn?Object(a.jsxs)("div",{className:O.a.btn,children:[!this.user.follow&&Object(a.jsx)(x.a,{type:"primary",className:O.a.follow,onClick:function(){return e.onFollowClick()},children:Object(a.jsxs)("div",{className:O.a.btnItem,children:[Object(a.jsx)(b.a,{name:"PlusOutlined",size:"14",className:O.a.btnIcon}),Object(a.jsx)("span",{children:"\u5173\u6ce8"})]})}),1===this.user.follow&&Object(a.jsx)(x.a,{type:"primary",className:g()(O.a.follow,O.a["is-followed"]),onClick:function(){return e.onFollowClick()},children:Object(a.jsxs)("div",{className:O.a.btnItem,children:[Object(a.jsx)(b.a,{name:"CheckOutlined",size:"14",className:O.a.btnIcon}),Object(a.jsx)("span",{children:"\u5df2\u5173\u6ce8"})]})}),2===this.user.follow&&Object(a.jsx)(x.a,{type:"primary",className:g()(O.a.follow,O.a["with-followed"]),onClick:function(){return e.onFollowClick()},children:Object(a.jsxs)("div",{className:O.a.btnItem,children:[Object(a.jsx)(b.a,{name:"WithdrawOutlined",size:"14",className:O.a.btnIcon}),Object(a.jsx)("span",{children:"\u4e92\u5173"})]})}),Object(a.jsx)(x.a,{className:O.a.privateLetter,onClick:function(){return e.onPrivateLetter()},children:Object(a.jsxs)("div",{className:O.a.btnItem,children:[Object(a.jsx)(b.a,{name:"CommentOutlined",size:"14",className:O.a.btnIcon}),Object(a.jsx)("span",{children:"\u53d1\u79c1\u4fe1"})]})})]}):""]})}}]),n}(f.a.Component))||i)||i;t.a=R},L0er:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("nKUr"),a=n("q1tI"),r=n("no3E"),s=n("5f2u"),o=n.n(s),c=n("z8Av");function l(e){var t=Object(a.useState)(e.text||"\u670d\u52a1\u5668\u9519\u8bef SERVER ERROR")[0];return Object(i.jsxs)("div",{className:r.a.page,children:[Object(i.jsx)(c.a,{}),Object(i.jsxs)("div",{className:r.a.body,children:[Object(i.jsx)("img",{alt:"\u56fe\u7247",className:r.a.icon,src:"/dzq-img/error.png"}),Object(i.jsx)("span",{className:r.a.text,children:t})]}),Object(i.jsx)("div",{className:r.a.footer,children:Object(i.jsx)(o.a,{onClick:function(){window.location.reload()},className:r.a.button,type:"primary",children:"\u70b9\u6211\u5237\u65b0"})})]})}},"TP+V":function(e,t,n){"use strict";n.r(t);n("ma9I"),n("QWBl"),n("yXV3"),n("oVuX"),n("qePV"),n("rB9j"),n("Rm1S"),n("UxlC"),n("FZtP"),n("R5XZ");var i=n("nKUr"),a=n("o0o1"),r=n.n(a),s=(n("ls82"),n("yXPU")),o=n.n(s),c=n("lwsE"),l=n.n(c),u=n("W8MJ"),d=n.n(u),p=n("7W2i"),h=n.n(p),v=n("a1gu"),m=n.n(v),f=n("Nsbk"),j=n.n(f),b=n("q1tI"),k=n.n(b),x=n("20a2"),C=n("yuBF"),O=n("sho3"),y=(n("TeQF"),n("2B1R"),n("hByQ"),n("lSNA")),D=n.n(y),w=n("B5JU"),g=n.n(w),N=n("B5zU"),R=n("HgT0"),P=(n("ACYA"),n("TSYQ")),I=n.n(P);var S=n("wrmh"),L=n("MCNy"),T=n.n(L),E=n("DetZ"),A=n.n(E),M=n("wdT/"),F=n.n(M),V=n("z8Av"),B=n("IvHc"),W=n("woGs"),z=n("33mu"),U=function(e){var t=e.showContent,n=e.setTop;return Object(i.jsxs)("div",{className:"".concat(z.a.setTop," ").concat(n?z.a.inTop:z.a.outTop),children:[Object(i.jsx)("span",{className:z.a.setTopIcon,children:Object(i.jsx)(T.a,{className:z.a.icon,name:"CheckOutlined"})}),t?"\u7f6e\u9876\u6210\u529f":"\u5df2\u53d6\u6d88\u7f6e\u9876"]})},_=n("aIz1"),q=n("c7hV"),H=n("iVyX"),G=n("dQ0f"),K=n("TibX"),X=n("z6Ap"),J=n("rOX+"),Q=n.n(J),Y=n("fkjL"),Z=n("k8W2"),$=n.n(Z),ee=n("5f2u"),te=n.n(ee),ne=n("x2xJ"),ie=n.n(ne),ae=n("/G68"),re=n("lY1M"),se=function(e){var t=e.visible,n=e.onOkClick,a=Object(b.useState)(""),s=a[0],c=a[1];Object(b.useEffect)((function(){c("")}),[t]);var l=function(){"function"===typeof(null===e||void 0===e?void 0:e.onCancel)&&e.onCancel()},u=function(){var e=o()(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(""===s||Number(s)<=0||Number(s)>1e6)){e.next=4;break}return(""===s||Number(s)<=0)&&F.a.error({content:"\u91d1\u989d\u4e0d\u80fd\u4e3a0"}),Number(s)>1e6&&F.a.error({content:"\u91d1\u989d\u4e0d\u80fd\u8d85\u8fc7100\u4e07"}),e.abrupt("return");case 4:if("function"!==typeof n){e.next=16;break}return e.prev=6,e.next=9,n(s);case 9:e.sent&&c(""),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(){return e.apply(this,arguments)}}(),d=function(){re.b.env("ios")&&setTimeout((function(){return function(){var e=document.body.scrollHeight;window.scrollTo(0,e)}()}),100)};return Object(i.jsx)($.a,{position:"bottom",visible:t,onClose:l,children:Object(i.jsxs)("div",{className:ae.a.container,children:[Object(i.jsx)("div",{className:ae.a.header,children:"\u652f\u4ed8\u4f5c\u8005\u7ee7\u7eed\u521b\u4f5c"}),Object(i.jsxs)("div",{className:ae.a.rewardInput,children:[Object(i.jsx)("span",{className:ae.a.prepend,children:"\u652f\u4ed8\u91d1\u989d"}),Object(i.jsx)(A.a,{mode:"number",placeholder:"\u91d1\u989d",className:ae.a.input,value:s,onChange:function(e){return function(e){var t=e.match(/([1-9]\d{0,6}|0)(\.\d{0,2})?/);c(t?t[0]:"")}(e.target.value)},onFocus:function(){return d()}}),Object(i.jsx)("span",{className:ae.a.append,children:"\u5143"})]}),Object(i.jsx)("div",{className:ae.a.rewardList,children:[1,2,5,10,20,50,88,128].map((function(e){return Object(i.jsxs)("div",{onClick:function(){return function(e){c(e)}(e)},className:I()(ae.a.reward,Number(s)===e&&ae.a.actived),children:["\uffe5",e]},e)}))}),Object(i.jsx)(ie.a,{className:ae.a.divider}),Object(i.jsxs)("div",{className:ae.a.button,children:[Object(i.jsx)(te.a,{onClick:l,className:ae.a.cancel,type:"default",children:"\u53d6\u6d88"}),Object(i.jsx)(te.a,{onClick:u,className:ae.a.ok,type:"primary",children:"\u786e\u5b9a"})]})]})})},oe=n("kjBj"),ce=n("RiVy"),le=(n("wLYn"),n("5MUC")),ue=n("RGe9"),de=n("NOng"),pe=n("HLiX"),he=n("Hg/G"),ve=n("JMBi"),me=n("f5Uc"),fe=(n("pNMO"),n("4Brf"),n("07d7"),n("9p2j"),n("zzKd"),Symbol("\u7ea2\u5305"),Symbol("\u8d4f\u91d1"),n("fEx9")),je=n("W7Eq"),be=(n("lW1z"),n("JuNc")),ke=n("zBpv"),xe=n("uYGS"),Ce=n("Bvw4"),Oe=n("bJLh"),ye=n("DTmq"),De=n("cwqe"),we=(n("n4oF"),n("4x5+")),ge=n.n(we),Ne=n("+p52"),Re=n("oAS2");ge.a.register(Ne.a),ge.a.register(Re.a);var Pe,Ie=Object(C.inject)("index","site","user","thread","plugin")(Object(C.observer)((function(e){var t,n,a,s,c,l,u,d,p,h,v,m,f,j,k,x,C,O,y,D,w,N,R,P,S,L,E,A,M,F,V,B,W,z,U,_,q,H,G,X,J,Q,Y,Z,$,ee,ne,ie,ae,re,se,oe,ce,we,ge,Ne,Re,Pe,Ie,Se=e.store,Le=e.site,Te=e.index,Ee=e.thread,Ae=e.user,Me=(null===Se||void 0===Se||null===(t=Se.threadData)||void 0===t?void 0:t.content)||{},Fe=Me.text,Ve=Me.indexes,Be=null===Se||void 0===Se?void 0:Se.threadData,We=Be.parentCategoryName,ze=Be.categoryName,Ue=Se.hasRedPacket,_e={postId:null===Se||void 0===Se||null===(n=Se.threadData)||void 0===n?void 0:n.postId,threadId:null===Se||void 0===Se||null===(a=Se.threadData)||void 0===a?void 0:a.threadId,platform:"h5",payType:null===Se||void 0===Se||null===(s=Se.threadData)||void 0===s?void 0:s.payType},qe=1===((null===Se||void 0===Se||null===(c=Se.threadData)||void 0===c?void 0:c.isApproved)||0),He=(null===Se||void 0===Se||null===(l=Se.threadData)||void 0===l||null===(u=l.displayTag)||void 0===u?void 0:u.isEssence)||!1,Ge=0===(null===Se||void 0===Se||null===(d=Se.threadData)||void 0===d?void 0:d.payType),Ke=(null===(p=e.user)||void 0===p||null===(h=p.userInfo)||void 0===h?void 0:h.id)&&(null===(v=e.user)||void 0===v||null===(m=v.userInfo)||void 0===m?void 0:m.id)===(null===Se||void 0===Se||null===(f=Se.threadData)||void 0===f?void 0:f.userId),Xe=!0===(null===Se||void 0===Se||null===(j=Se.threadData)||void 0===j?void 0:j.paid),Je=null===Se||void 0===Se||null===(k=Se.threadData)||void 0===k?void 0:k.ability.canFreeViewPost,Qe=2===(null===Se||void 0===Se||null===(x=Se.threadData)||void 0===x?void 0:x.payType)&&!1===(null===Se||void 0===Se||null===(C=Se.threadData)||void 0===C?void 0:C.paid),Ye=(null===Se||void 0===Se||null===(O=Se.threadData)||void 0===O?void 0:O.attachmentPrice)||0,Ze=!Je&&Qe&&!Ke&&!Xe,$e=1===(null===Se||void 0===Se||null===(y=Se.threadData)||void 0===y?void 0:y.payType),et=(null===Se||void 0===Se||null===(D=Se.threadData)||void 0===D?void 0:D.price)||0,tt=(1===(null===Se||void 0===Se||null===(w=Se.threadData)||void 0===w?void 0:w.payType)&&(null===Se||void 0===Se||null===(N=Se.threadData)||void 0===N||N.paid),null===Se||void 0===Se||null===(R=Se.threadData)||void 0===R||null===(P=R.displayTag)||void 0===P?void 0:P.isRedPack),nt=null===Se||void 0===Se||null===(S=Se.threadData)||void 0===S||null===(L=S.displayTag)||void 0===L?void 0:L.isReward,it=Ge&&(null===Se||void 0===Se||null===(E=Se.threadData)||void 0===E?void 0:E.ability.canBeReward)&&!tt&&!nt,at=null===Se||void 0===Se||null===(A=Se.threadData)||void 0===A?void 0:A.isReward,rt=Object(le.a)(Ve);Ae.isLogin()&&qe&&1===(null===(M=rt.RED_PACKET)||void 0===M?void 0:M.condition)&&Se.getRedPacketInfo(rt.RED_PACKET.threadId);var st=function(){var t=o()(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"function"===typeof e.onPayClick&&e.onPayClick();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ot=function(){"function"===typeof e.onRewardClick&&e.onRewardClick()};Object(b.useEffect)((function(){var t;(null===(t=rt.IMAGE)||void 0===t?void 0:t.length)!==Se.contentImgLength&&rt.IMAGE||e.setContentImgReady()}),[Se.contentImgLength]);var ct=(null===Se||void 0===Se||null===(F=Se.threadData)||void 0===F?void 0:F.ability)||{},lt=ct.canDownloadAttachment,ut=ct.canViewAttachment,dt=ct.canViewVideo,pt=((null===Se||void 0===Se?void 0:Se.threadData)||{}).tipList;return Object(i.jsxs)("div",{className:"".concat(ke.a.container),children:[Object(i.jsxs)("div",{className:ke.a.header,children:[Object(i.jsx)("div",{className:ke.a.userInfo,children:Object(i.jsx)(be.a,{name:(null===Se||void 0===Se||null===(V=Se.threadData)||void 0===V||null===(B=V.user)||void 0===B?void 0:B.nickname)||"",avatar:(null===Se||void 0===Se||null===(W=Se.threadData)||void 0===W||null===(z=W.user)||void 0===z?void 0:z.avatar)||"",location:(null===Se||void 0===Se||null===(U=Se.threadData)||void 0===U?void 0:U.position.location)||"",groupName:(null===Se||void 0===Se||null===(_=Se.threadData)||void 0===_||null===(q=_.group)||void 0===q?void 0:q.groupName)||"",groupLevel:(null===Se||void 0===Se||null===(H=Se.threadData)||void 0===H||null===(G=H.group)||void 0===G?void 0:G.level)||0,view:"".concat(null===Se||void 0===Se||null===(X=Se.threadData)||void 0===X?void 0:X.viewCount)||"",time:"".concat(null===Se||void 0===Se||null===(J=Se.threadData)||void 0===J?void 0:J.diffTime)||"",isEssence:He,isPay:!Ge,isReward:nt,isRed:tt,userId:null===Se||void 0===Se||null===(Q=Se.threadData)||void 0===Q||null===(Y=Q.user)||void 0===Y?void 0:Y.userId,onClick:function(t){"function"===typeof e.onUserClick&&e.onUserClick(t)}})}),(null===e||void 0===e||null===(Z=e.user)||void 0===Z?void 0:Z.isLogin())&&qe&&Object(i.jsx)("div",{className:ke.a.more,onClick:function(){e.fun.moreClick()},children:Object(i.jsx)(T.a,{size:20,color:"#8590A6",name:"MoreVOutlined"})})]}),Object(i.jsxs)("div",{className:ke.a.body,children:[(null===Se||void 0===Se||null===($=Se.threadData)||void 0===$?void 0:$.title)&&Object(i.jsx)("div",{className:ke.a.title,children:null===Se||void 0===Se||null===(ee=Se.threadData)||void 0===ee?void 0:ee.title}),Fe&&Object(i.jsx)(pe.a,{needShowMore:!1,content:Fe||""}),rt.VIDEO&&1!==rt.VIDEO.needPay&&Object(i.jsx)(ve.a,{url:rt.VIDEO.mediaUrl,coverUrl:rt.VIDEO.coverUrl,v_height:rt.VIDEO.height||null,v_width:rt.VIDEO.width||null,status:rt.VIDEO.status,canViewVideo:dt}),rt.IFRAME&&Object(i.jsx)(xe.a,{content:rt.IFRAME.content}),rt.IMAGE&&Object(i.jsx)(ue.a,{postLoad:function(){Se.setContentImgLength()},flat:!0,platform:"h5",imgData:rt.IMAGE,isPay:Ze,onPay:st}),(rt.RED_PACKET||rt.REWARD)&&Object(i.jsxs)("div",{className:ke.a.reward,children:[Le.webConfig.setSite.siteAreward[1].value&&Object(i.jsx)(i.Fragment,{children:rt.REWARD&&Object(i.jsxs)("div",{className:ke.a.rewardBody,style:{width:"100%"},children:[Object(i.jsx)(Oe.a,{type:1,money:rt.REWARD.money,remainMoney:rt.REWARD.remainMoney}),Object(i.jsxs)("div",{className:ke.a.rewardText,children:[Object(i.jsxs)("div",{className:ke.a.rewardMoney,children:["\u672c\u5e16\u5411\u6240\u6709\u4eba\u60ac\u8d4f",Object(i.jsx)("span",{className:ke.a.rewardNumber,children:rt.REWARD.money||0}),"\u5143"]}),Object(i.jsxs)("div",{className:ke.a.rewardTime,children:[rt.REWARD.expiredAt,"\u622a\u6b62\u60ac\u8d4f"]})]})]})}),Le.webConfig.setSite.siteRedpacket[1].value&&Object(i.jsx)(i.Fragment,{children:rt.RED_PACKET&&Object(i.jsxs)("div",{style:{width:"100%"},children:[Object(i.jsx)(Oe.a,{number:rt.RED_PACKET.number,remainNumber:rt.RED_PACKET.remainNumber,condition:rt.RED_PACKET.condition}),!!rt.RED_PACKET.condition&&Object(i.jsxs)("div",{className:ke.a.redPacketLikeNum,children:["\u8bc4\u8bba\u96c6",rt.RED_PACKET.likenum,"\u8d5e\u9886\u7ea2\u5305"]})]})})]}),Le.webConfig.setSite.siteShop[1].value&&Object(i.jsx)(i.Fragment,{children:rt.GOODS&&Object(i.jsxs)("div",{children:[Object(i.jsx)(he.a,{image:rt.GOODS.imagePath,amount:rt.GOODS.price,title:rt.GOODS.title,className:ke.a.product}),Object(i.jsxs)(te.a,{className:ke.a.buyBtn,type:"danger",onClick:function(){var e;(e=rt.GOODS.detailContent)&&window.open(e)},children:[Object(i.jsx)(T.a,{className:ke.a.payIcon,name:"ShoppingCartOutlined",size:20}),Object(i.jsx)("span",{className:ke.a.buyText,children:"\u8d2d\u4e70\u5546\u54c1"})]})]})}),rt.VOICE&&Object(i.jsx)(de.a,{url:rt.VOICE.mediaUrl}),rt.VOTE&&Object(i.jsx)(je.a,{attachments:rt.VOTE,threadId:null===Se||void 0===Se||null===(ne=Se.threadData)||void 0===ne?void 0:ne.threadId,canDownloadAttachment:lt,canViewAttachment:ut}),rt.VOTE_THREAD&&Object(i.jsx)(me.a,{voteData:rt.VOTE_THREAD,threadId:null===Se||void 0===Se||null===(ie=Se.threadData)||void 0===ie?void 0:ie.threadId,page:"detail"}),Object(i.jsx)(De.default,{target:"plugin_detail",hookName:"thread_extension_display_hook",pluginProps:{threadData:null===Se||void 0===Se?void 0:Se.threadData,renderData:rt.plugin,updateListThreadIndexes:Te.updateListThreadIndexes.bind(Te),updateThread:Ee.updateThread.bind(Ee)}}),Le.webConfig.setSite.sitePay[1].value&&Object(i.jsx)(i.Fragment,{children:Ze&&Object(i.jsx)("div",{style:{textAlign:"center"},onClick:st,children:Object(i.jsxs)(te.a,{className:ke.a.payButton,type:"primary",children:[Object(i.jsx)(T.a,{className:ke.a.payIcon,name:"GoldCoinOutlined",size:16}),Object(i.jsxs)("p",{children:["\u652f\u4ed8",Ye,"\u5143\u67e5\u770b\u4ed8\u8d39\u5185\u5bb9"]})]})})}),(We||ze)&&Object(i.jsx)("div",{className:ke.a.tag,onClick:function(){"function"===typeof e.onTagClick&&e.onTagClick()},children:We?"".concat(We,"/").concat(ze):ze}),Le.webConfig.setSite.sitePay[1].value&&Object(i.jsx)(i.Fragment,{children:!Je&&$e&&!Ke&&!Xe&&Object(i.jsx)("div",{style:{textAlign:"center"},onClick:st,children:Object(i.jsxs)(te.a,{className:ke.a.payButton,type:"primary",children:[Object(i.jsx)(T.a,{className:ke.a.payIcon,name:"GoldCoinOutlined",size:16}),"\u652f\u4ed8",et,"\u5143\u67e5\u770b\u5269\u4f59\u5185\u5bb9"]})})}),Le.webConfig.setSite.siteRewards[1].value&&Object(i.jsx)("div",{className:"".concat(ke.a.rewardContianer," ").concat(ke.a.kuqJuzhong),children:Object(i.jsxs)(te.a,{onClick:ot,className:ke.a.rewardButton,type:"primary",children:[Object(i.jsx)(T.a,{className:ke.a.payIcon,name:"HeartOutlined",size:20}),Object(i.jsx)("span",{className:ke.a.rewardext,children:"\u6253 \u8d4f"})]})}),pt&&pt.length>0&&Object(i.jsxs)("div",{className:ke.a.moneyList,children:[Object(i.jsxs)("div",{className:ke.a.top,children:[pt.length,"\u4eba\u6253\u8d4f"]}),Object(i.jsx)("div",{className:ke.a.itemList,children:pt.map((function(e){return Object(i.jsx)("div",{onClick:function(){return g.a.push({url:"/user/".concat(e.userId)})},className:ke.a.itemAvatar,children:Object(i.jsx)(Ce.a,{image:e.avatar,name:e.nickname,size:"small"})},e.userId)}))})]})]}),qe&&Object(i.jsxs)("div",{className:ke.a.footer,children:[Object(i.jsxs)("div",{className:ke.a.thumbs,children:[$e&&Object(i.jsx)(T.a,{className:I()(ke.a.payIcon,Xe&&ke.a.actived),name:"GoldCoinOutlined",size:20}),it&&Object(i.jsx)(T.a,{onClick:function(){return!Ke&&ot()},className:I()(ke.a.payIcon,at&&ke.a.actived),name:"HeartOutlined",size:20}),Object(i.jsxs)("div",{className:I()(ke.a.liked,(null===Se||void 0===Se||null===(ae=Se.threadData)||void 0===ae?void 0:ae.isLike)&&ke.a.actived),onClick:Object(K.a)((function(){"function"===typeof e.onLikeClick&&e.onLikeClick()}),500),children:[Object(i.jsx)(T.a,{name:"LikeOutlined",size:20}),(null===Se||void 0===Se||null===(re=Se.threadData)||void 0===re||null===(se=re.likeReward)||void 0===se?void 0:se.likePayCount)>0&&Object(i.jsx)("span",{className:ke.a.likedNumber,children:(null===Se||void 0===Se||null===(oe=Se.threadData)||void 0===oe||null===(ce=oe.likeReward)||void 0===ce?void 0:ce.likePayCount)||""})]}),Object(i.jsx)("div",{className:ke.a.likeReward,children:Object(i.jsx)(fe.a,{tipData:_e,imgs:(null===Se||void 0===Se||null===(we=Se.threadData)||void 0===we||null===(ge=we.likeReward)||void 0===ge?void 0:ge.users)||[],showMore:!0,showCount:5,platform:"h5"})})]}),(null===Se||void 0===Se||null===(Ne=Se.threadData)||void 0===Ne||null===(Re=Ne.likeReward)||void 0===Re?void 0:Re.shareCount)>0&&Object(i.jsxs)("div",{className:ke.a.shareCount,children:[null===Se||void 0===Se||null===(Pe=Se.threadData)||void 0===Pe||null===(Ie=Pe.likeReward)||void 0===Ie?void 0:Ie.shareCount,"\u6b21\u5206\u4eab"]})]}),Ue>0&&Object(i.jsx)(ye.a,{onClose:function(){return Se.setRedPacket(0)},money:Ue})]})}))),Se=(n("ToJy"),n("7mQc")),Le=n("X3A+"),Te=n("iJKD"),Ee=n("C3nd");function Ae(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=j()(e);if(t){var a=j()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return m()(this,n)}}var Me=Object(C.inject)("thread")(Pe=Object(C.inject)("comment")(Pe=Object(C.inject)("commentPosition")(Pe=Object(C.inject)("user")(Pe=Object(C.inject)("site")(Pe=Object(C.observer)(Pe=function(e){h()(n,e);var t=Ae(n);function n(e){var i;return l()(this,n),(i=t.call(this,e)).onSortClick=o()(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof i.props.sort){e.next=11;break}return e.prev=1,e.next=4,i.props.sort(!i.state.commentSort);case 4:e.sent&&i.setState({commentSort:!i.state.commentSort}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),i.state={showAboptPopup:!1,showCommentInput:!1,commentSort:!0,showDeletePopup:!1,showReplyDeletePopup:!1,inputText:"\u8bf7\u8f93\u5165\u5185\u5bb9"},i.commentData=null,i.replyData=null,i.recordCommentLike={id:null,status:null},i.recordReplyLike={id:null,status:null},i}return d()(n,[{key:"likeClick",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(B.a)({url:"/user/login"}),e.abrupt("return");case 4:if(t.id){e.next=6;break}return e.abrupt("return");case 6:if(this.recordCommentLike.id!==t.id&&(this.recordCommentLike.status=null),this.recordCommentLike.status===t.isLiked){e.next=12;break}this.recordCommentLike.status=t.isLiked,this.recordCommentLike.id=t.id,e.next=13;break;case 12:return e.abrupt("return");case 13:return n={id:t.id,isLiked:!t.isLiked},e.next=16,this.props.comment.updateLiked(n,this.props.thread);case 16:i=e.sent,a=i.success,s=i.msg,a&&(this.props.isPositionComment?(this.props.commentPosition.setCommentListDetailField(t.id,"isLiked",n.isLiked),o=n.isLiked?t.likeCount+1:t.likeCount-1,this.props.commentPosition.setCommentListDetailField(t.id,"likeCount",o)):(this.props.thread.setCommentListDetailField(t.id,"isLiked",n.isLiked),c=n.isLiked?t.likeCount+1:t.likeCount-1,this.props.thread.setCommentListDetailField(t.id,"likeCount",c))),a||F.a.error({content:s});case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replyLikeClick",value:function(){var e=o()(r.a.mark((function e(t,n){var i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id){e.next=2;break}return e.abrupt("return");case 2:if(this.props.user.isLogin()){e.next=6;break}return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(B.a)({url:"/user/login"}),e.abrupt("return");case 6:if(this.recordReplyLike.id!==t.id&&(this.recordReplyLike.status=null),this.recordReplyLike.status===t.isLiked){e.next=12;break}this.recordReplyLike.status=t.isLiked,this.recordReplyLike.id=t.id,e.next=13;break;case 12:return e.abrupt("return");case 13:return i={id:t.id,isLiked:!t.isLiked},e.next=16,this.props.comment.updateLiked(i);case 16:a=e.sent,s=a.success,o=a.msg,this.props.isPositionComment?(this.props.commentPosition.setReplyListDetailField(n.id,t.id,"isLiked",i.isLiked),c=i.isLiked?t.likeCount+1:t.likeCount-1,this.props.commentPosition.setReplyListDetailField(n.id,t.id,"likeCount",c)):(this.props.thread.setReplyListDetailField(n.id,t.id,"isLiked",i.isLiked),l=i.isLiked?t.likeCount+1:t.likeCount-1,this.props.thread.setReplyListDetailField(n.id,t.id,"likeCount",l)),s||F.a.error({content:o});case 21:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteClick",value:function(){var e=o()(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.commentData=t,this.setState({showDeletePopup:!0});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteComment",value:function(){var e=o()(r.a.mark((function e(){var t,n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.commentData.id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.props.comment.delete(this.commentData.id,this.props.isPositionComment?this.props.commentPosition:this.props.thread);case 4:if(t=e.sent,n=t.success,i=t.msg,this.setState({showDeletePopup:!1}),!n){e.next=11;break}return F.a.success({content:"\u5220\u9664\u6210\u529f"}),e.abrupt("return");case 11:F.a.error({content:i});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"replyDeleteClick",value:function(){var e=o()(r.a.mark((function e(t,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.commentData=n,this.replyData=t,this.setState({showReplyDeletePopup:!0});case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"replyDeleteComment",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.replyData.id){e.next=2;break}return e.abrupt("return");case 2:return t={},this.replyData&&this.commentData&&(t.replyData=this.replyData,t.commentData=this.commentData),e.next=6,this.props.comment.deleteReplyComment(t,this.props.isPositionComment?this.props.commentPosition:this.props.thread);case 6:if(n=e.sent,i=n.success,a=n.msg,this.setState({showReplyDeletePopup:!1}),!i){e.next=13;break}return F.a.success({content:"\u5220\u9664\u6210\u529f"}),e.abrupt("return");case 13:F.a.error({content:a});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"replyClick",value:function(e){var t,n;if(!this.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});if(this.props.canPublish("reply")){this.commentData=e,this.replyData=null;var i=(null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.nickname)||(null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.userName);this.setState({showCommentInput:!0,inputText:i?"\u56de\u590d".concat(i):"\u8bf7\u8f93\u5165\u5185\u5bb9"})}}},{key:"replyReplyClick",value:function(e,t){var n,i;if(!this.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});if(this.props.canPublish("reply")){this.commentData=null,this.replyData=e,this.replyData.commentId=t.id;var a=(null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.nickname)||(null===e||void 0===e||null===(i=e.user)||void 0===i?void 0:i.userName);this.setState({showCommentInput:!0,inputText:a?"\u56de\u590d".concat(a):"\u8bf7\u8f93\u5165\u5185\u5bb9"})}}},{key:"createReply",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p,h,v,m,f,j,b,k,x=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=x.length>0&&void 0!==x[0]?x[0]:"",a=x.length>1&&void 0!==x[1]?x[1]:[],i.replace(/\s/g,"")||0!==a.length){e.next=6;break}return F.a.info({content:"\u8bf7\u8f93\u5165\u5185\u5bb9"}),e.abrupt("return");case 6:if(s=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id){e.next=9;break}return e.abrupt("return");case 9:if(o={id:s,content:i},this.replyData&&(o.replyId=this.replyData.id,o.isComment=!0,o.commentId=this.replyData.commentId,o.commentPostId=this.replyData.id),this.commentData&&(o.replyId=this.commentData.id,o.isComment=!0,o.commentId=this.commentData.id),null!==a&&void 0!==a&&a.length&&(o.attachments=a.filter((function(e){return"success"===e.status&&e.response})).map((function(e){return{id:e.response.id,type:"attachments"}}))),!(c=this.props.site.webConfig)){e.next=27;break}if(d=null===c||void 0===c||null===(l=c.qcloud)||void 0===l?void 0:l.qcloudCaptcha,p=null===c||void 0===c||null===(u=c.other)||void 0===u?void 0:u.createThreadWithCaptcha,!d||!p){e.next=27;break}return e.next=20,this.props.showCaptcha();case 20:if(h=e.sent,v=h.captchaTicket,m=h.captchaRandStr,v||m){e.next=25;break}return e.abrupt("return",!1);case 25:o.captchaTicket=v,o.captchaRandStr=m;case 27:return e.next=29,this.props.comment.createReply(o,this.props.isPositionComment?this.props.commentPosition:this.props.thread);case 29:if(f=e.sent,j=f.success,b=f.msg,k=f.isApproved,!j){e.next=37;break}return this.setState({showCommentInput:!1,inputValue:""}),k?F.a.success({content:b}):F.a.warning({content:b}),e.abrupt("return",!0);case 37:F.a.error({content:b});case 38:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"editClick",value:function(e){"function"===typeof this.props.onEditClick&&this.props.onEditClick(e)}},{key:"onCommentClick",value:function(e){var t,n,i,a;e.id&&null!==(t=this.props.thread)&&void 0!==t&&null!==(n=t.threadData)&&void 0!==n&&n.id&&g.a.push({url:"/thread/comment/".concat(e.id,"?threadId=").concat(null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.id)})}},{key:"onAboptClick",value:function(e){if(!this.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});this.commentData=e,this.setState({showAboptPopup:!0})}},{key:"onAboptOk",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>0)){e.next=15;break}return s={postId:null===(n=this.commentData)||void 0===n?void 0:n.id,rewards:t,threadId:null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.threadId},e.next=4,this.props.thread.reward(s);case 4:if(o=e.sent,c=o.success,l=o.msg,!c){e.next=12;break}return this.setState({showAboptPopup:!1}),this.props.thread.fetchThreadDetail(s.threadId),F.a.success({content:"\u60ac\u8d4f".concat(t,"\u5143")}),e.abrupt("return",!0);case 12:F.a.error({content:l}),e.next=16;break;case 15:F.a.info({content:"\u60ac\u8d4f\u91d1\u989d\u4e0d\u80fd\u4e3a0"});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onAboptCancel",value:function(){this.commentData=null,this.setState({showAboptPopup:!1})}},{key:"avatarClick",value:function(e){var t=e.userId;t&&g.a.push({url:"/user/".concat(t)})}},{key:"replyAvatarClick",value:function(e,t,n){"function"===typeof this.props.replyAvatarClick&&this.props.replyAvatarClick(e,t,n)}},{key:"render",value:function(){var e,t,n,a,r,s,o,c,l,u,d,p,h,v,m=this,f=this.props.thread,j=f.totalCount,k=f.commentList,x=this.props.commentPosition,C=x.commentList,O=x.postId;this.props.isPositionComment&&(k=C||[]);var y=(null===(e=this.props.user)||void 0===e||null===(t=e.userInfo)||void 0===t?void 0:t.id)&&(null===(n=this.props.user)||void 0===n||null===(a=n.userInfo)||void 0===a?void 0:a.id)===(null===(r=this.props.thread)||void 0===r||null===(s=r.threadData)||void 0===s?void 0:s.userId),D=null===(o=this.props.thread)||void 0===o||null===(c=o.threadData)||void 0===c||null===(l=c.displayTag)||void 0===l?void 0:l.isReward,w=((null===(u=this.props.thread)||void 0===u||null===(d=u.threadData)||void 0===d?void 0:d.content)||{}).indexes,g=((null===(p=this.props.thread)||void 0===p?void 0:p.threadData)||"").isAnonymous,N=Object(le.a)(w);return Object(i.jsxs)(b.Fragment,{children:[this.props.showHeader&&Object(i.jsxs)("div",{className:Te.a.header,children:[Object(i.jsxs)("div",{className:Te.a.number,children:["\u5171",j,"\u6761\u8bc4\u8bba"]}),Object(i.jsxs)("div",{className:Te.a.sort,onClick:function(){return m.onSortClick()},children:[Object(i.jsx)(T.a,{className:Te.a.sortIcon,name:"SortOutlined"}),Object(i.jsx)("span",{className:Te.a.sortText,children:this.state.commentSort?"\u8bc4\u8bba\u4ece\u65b0\u5230\u65e7":"\u8bc4\u8bba\u4ece\u65e7\u5230\u65b0"})]})]}),Object(i.jsx)("div",{className:Te.a.body,children:k.map((function(e,t){var n,a,r,s;return Object(i.jsx)("div",{className:"".concat(Te.a.commentItems," ").concat(t===k.length-1&&Te.a.isLastOne),ref:e.id===O?m.props.positionRef:null,children:Object(i.jsx)(Se.a,{data:e,likeClick:Object(K.a)((function(){return m.likeClick(e)}),500),avatarClick:function(){return m.avatarClick(e)},replyClick:function(){return m.replyClick(e)},deleteClick:function(){return m.deleteClick(e)},editClick:function(){return m.editClick(e)},replyAvatarClick:function(t,n){return m.replyAvatarClick(t,e,n)},replyLikeClick:Object(K.a)((function(t){return m.replyLikeClick(t,e)}),500),replyReplyClick:function(t){return m.replyReplyClick(t,e)},replyDeleteClick:function(t){return m.replyDeleteClick(t,e)},onCommentClick:function(){return m.onCommentClick(e)},onAboptClick:function(){return m.onAboptClick(e)},isShowOne:!0,isShowAdopt:y&&D&&(null===(n=m.props.thread)||void 0===n||null===(a=n.threadData)||void 0===a?void 0:a.userId)!==e.userId,thread:m.props.thread,threadId:null===(r=m.props.thread)||void 0===r||null===(s=r.threadData)||void 0===s?void 0:s.userId,active:e.id===O,isAnonymous:g,redPacketData:null===N||void 0===N?void 0:N.RED_PACKET},e.id)},e.id||t)}))}),Object(i.jsx)(H.a,{visible:this.state.showCommentInput,inputText:this.state.inputText,onClose:function(){return m.setState({showCommentInput:!1})},onSubmit:function(e,t){return m.createReply(e,t)},site:this.props.site}),Object(i.jsx)(_.a,{visible:this.state.showDeletePopup,onClose:function(){return m.setState({showDeletePopup:!1})},onBtnClick:function(){return m.deleteComment()}}),Object(i.jsx)(_.a,{visible:this.state.showReplyDeletePopup,onClose:function(){return m.setState({showReplyDeletePopup:!1})},onBtnClick:function(){return m.replyDeleteComment()}}),(null===N||void 0===N||null===(h=N.REWARD)||void 0===h?void 0:h.money)&&(null===N||void 0===N||null===(v=N.REWARD)||void 0===v?void 0:v.remainMoney)&&Object(i.jsx)(Le.a,{money:Number(N.REWARD.money),remainMoney:Number(N.REWARD.remainMoney),visible:this.state.showAboptPopup,onCancel:function(){return m.onAboptCancel()},onOkClick:function(e){return m.onAboptOk(e)}})]})}}]),n}(k.a.Component))||Pe)||Pe)||Pe)||Pe)||Pe)||Pe;Me.defaultProps={showHeader:!0};var Fe,Ve=Object(Ee.a)(Me),Be=n("ni5c"),We=n("wXCO"),ze=n("FeKq");function Ue(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=j()(e);if(t){var a=j()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return m()(this,n)}}var _e,qe=Object(C.inject)("site")(Fe=Object(C.inject)("user")(Fe=Object(C.inject)("thread")(Fe=Object(C.inject)("commentPosition")(Fe=Object(C.inject)("comment")(Fe=Object(C.inject)("index")(Fe=Object(C.inject)("card")(Fe=Object(C.inject)("vlist")(Fe=Object(C.observer)(Fe=function(e){h()(n,e);var t=Ue(n);function n(e){var i,a,s;return l()(this,n),(s=t.call(this,e)).setContentImgReady=function(){s.setState({contentImgIsReady:!0})},s.onMoreClick=function(){s.setState({showMorePopup:!0})},s.onOperClick=function(e){if(!s.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});if(s.setState({showMorePopup:!1}),"stick"===e&&s.updateStick(),"essence"===e&&s.updateEssence(),"delete"===e&&s.setState({showDeletePopup:!0}),"edit"===e){var t,n,i,a;if(null===(t=s.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n||!n.id)return;g.a.push({url:"/thread/post?id=".concat(null===(i=s.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.id)})}"report"===e&&s.setState({showReportPopup:!0}),"collect"===e&&s.onCollectionClick(),"wxshare"===e&&s.onShareClick(),"copylink"===e&&s.handleH5Share(),"post"===e&&s.createCard()},s.handleClick=function(){s.props.user.isLogin()?s.setState({show:!0}):Object(B.a)({url:"/user/login"})},s.onShareClose=function(){s.setState({show:!1})},s.handleH5Share=o()(r.a.mark((function e(){var t,n,i,a,o,c,l,u,d,p,h,v;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F.a.info({content:"\u590d\u5236\u94fe\u63a5\u6210\u529f"}),s.onShareClose(),c=(null===(t=s.props.thread)||void 0===t?void 0:t.threadData)||{},l=c.title,u=void 0===l?"":l,Q()({title:u,path:"thread/".concat(null===(n=s.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i?void 0:i.threadId)}),d=null===(a=s.props.thread)||void 0===a||null===(o=a.threadData)||void 0===o?void 0:o.id,e.next=7,s.props.thread.shareThread(d,s.props.index,s.props.search,s.props.topic);case 7:p=e.sent,h=p.success,v=p.msg,h||F.a.error({content:v});case 11:case"end":return e.stop()}}),e)}))),s.handleWxShare=function(){s.setState({isShowWeiXinShare:!0}),s.onShareClose(),s.onShareClick()},s.createCard=o()(r.a.mark((function e(){var t,n,i,a,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.props.thread.threadData,n=t.id,i=s.props.card,e.next=5,s.props.thread.shareThread(n,s.props.index,s.props.search,s.props.topic);case 5:a=e.sent,o=a.success,c=a.msg,o||F.a.error({content:c}),i.setThreadData(t),g.a.push({url:"/card?threadId=".concat(n)});case 11:case"end":return e.stop()}}),e)}))),s.state={loadWeiXin:!1,isShowWeiXinShare:!1,showReportPopup:!1,showDeletePopup:!1,showCommentInput:!1,showMorePopup:!1,showRewardPopup:!1,isCommentLoading:!1,setTop:!1,showContent:"",show:!1,stateFlag:!(null!==(i=s.props.thread)&&void 0!==i&&i.isPositionToComment),contentImgIsReady:!1},s.perPage=20,s.commentDataSort=!0,s.threadBodyRef=k.a.createRef(),s.commentDataRef=k.a.createRef(),s.position=0,s.nextPosition=0,s.flag=!(null!==(a=s.props.thread)&&void 0!==a&&a.isPositionToComment),s.isFirst=!0,s.comment=null,s.reportContent=["\u5e7f\u544a\u5783\u573e","\u8fdd\u89c4\u5185\u5bb9","\u6076\u610f\u704c\u6c34","\u91cd\u590d\u53d1\u5e16"],s.inputText="\u5176\u4ed6\u7406\u7531...",s.positionRef=k.a.createRef(),s.isPositioned=!1,s}return d()(n,[{key:"handleOnScroll",value:function(){var e,t,n,i,a,r,s,o,c=null===(e=this.threadBodyRef)||void 0===e||null===(t=e.current)||void 0===t?void 0:t.scrollTop,l=null===(n=this.threadBodyRef)||void 0===n||null===(i=n.current)||void 0===i?void 0:i.offsetHeight,u=null===(a=this.threadBodyRef)||void 0===a||null===(r=a.current)||void 0===r?void 0:r.scrollHeight,d=this.props.thread,p=d.isCommentReady,h=d.isNoMore;(this.props.thread.setScrollDistance(c),c+l>=u&&!this.state.isCommentLoading&&p&&!h&&(this.props.thread.setCommentListPage(this.props.thread.page+1),this.loadCommentList()),this.flag)&&(this.nextPosition=(null===(s=this.threadBodyRef)||void 0===s||null===(o=s.current)||void 0===o?void 0:o.scrollTop)||0)}},{key:"componentDidMount",value:function(){this.setState({loadWeiXin:Object(ce.a)()})}},{key:"componentDidUpdate",value:function(){var e,t,n=this;if(this.isFirst){var i=this.props.thread;if(this.state.contentImgIsReady){var a,r,s,o;if(this.isFirst=!1,this.position=(null===(a=this.commentDataRef)||void 0===a||null===(r=a.current)||void 0===r?void 0:r.offsetTop)-50,i.clearContentImgState(),null!==(s=this.props)&&void 0!==s&&null!==(o=s.thread)&&void 0!==o&&o.isPositionToComment)return void setTimeout((function(){var e,t;null===(e=n.threadBodyRef)||void 0===e||null===(t=e.current)||void 0===t||t.scrollTo(0,n.position)}),1e3);this.threadBodyRef.current.scrollTo(0,this.props.thread.scrollDistance)}null!==(e=this.props.commentPosition)&&void 0!==e&&e.postId&&!this.isPositioned&&null!==(t=this.positionRef)&&void 0!==t&&t.current&&(this.isPositioned=!0,setTimeout((function(){n.positionRef.current.scrollIntoView()}),1e3))}}},{key:"componentWillUnmount",value:function(){}},{key:"onMessageClick",value:function(){var e=this.flag?this.position:0;this.flag=!this.flag,this.setState({stateFlag:this.flag}),this.threadBodyRef.current.scrollTo(0,e)}},{key:"onCollectionClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(B.a)({url:"/user/login"}),e.abrupt("return");case 4:return a=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,s={id:a,isFavorite:!(null!==(i=this.props.thread)&&void 0!==i&&i.isFavorite)},e.next=8,this.props.thread.updateFavorite(s);case 8:if(o=e.sent,c=o.success,l=o.msg,!c){e.next=14;break}return F.a.success({content:s.isFavorite?"\u6536\u85cf\u6210\u529f":"\u53d6\u6d88\u6536\u85cf"}),e.abrupt("return");case 14:F.a.error({content:l});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadCommentList",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.props.thread.isCommentReady,!this.state.isCommentLoading&&i){e.next=3;break}return e.abrupt("return");case 3:return this.setState({isCommentLoading:!0}),a=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,s={id:a,page:this.props.thread.page,perPage:this.perPage,sort:this.commentDataSort?"createdAt":"-createdAt"},e.next=8,this.props.thread.loadCommentList(s);case 8:if(o=e.sent,c=o.success,l=o.msg,this.setState({isCommentLoading:!1}),!c){e.next=14;break}return e.abrupt("return",!0);case 14:F.a.error({content:l});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onSortChange",value:function(e){return this.commentDataSort=e,this.props.thread.setCommentListPage(1),this.props.commentPosition.reset(),this.loadCommentList()}},{key:"onInputClick",value:function(){if(!this.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});this.props.canPublish("reply")&&this.setState({showCommentInput:!0})}},{key:"onReportOk",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n={threadId:this.props.thread.threadData.threadId,type:1,reason:t,userId:this.props.user.userInfo.id},e.next=5,this.props.thread.createReports(n);case 5:if(i=e.sent,a=i.success,s=i.msg,!a){e.next=12;break}return F.a.success({content:"\u64cd\u4f5c\u6210\u529f"}),this.setState({showReportPopup:!1}),e.abrupt("return",!0);case 12:F.a.error({content:s});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setTopState",value:function(e){var t=this;this.setState({showContent:e,setTop:!this.state.setTop}),setTimeout((function(){t.setState({setTop:!t.state.setTop})}),2e3)}},{key:"updateStick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,o={id:s,isStick:!(null!==(i=this.props.thread)&&void 0!==i&&null!==(a=i.threadData)&&void 0!==a&&a.isStick)},e.next=4,this.props.thread.updateStick(o);case 4:if(c=e.sent,l=c.success,u=c.msg,!l){e.next=11;break}return this.setTopState(o.isStick),(null===(d=this.props)||void 0===d||null===(p=d.index)||void 0===p?void 0:p.refreshHomeData)&&this.props.index.refreshHomeData(),e.abrupt("return");case 11:F.a.error({content:u});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateEssence",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,c={id:o,isEssence:!(null!==(i=this.props.thread)&&void 0!==i&&null!==(a=i.threadData)&&void 0!==a&&null!==(s=a.displayTag)&&void 0!==s&&s.isEssence)},e.next=4,this.props.thread.updateEssence(c);case 4:if(l=e.sent,u=l.success,d=l.msg,this.props.thread.updateListStore(),!u){e.next=11;break}return F.a.success({content:"\u64cd\u4f5c\u6210\u529f"}),e.abrupt("return");case 11:F.a.error({content:d});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({showDeletePopup:!1}),i=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,e.next=4,this.props.thread.delete(i);case 4:if(a=e.sent,s=a.success,o=a.msg,!s){e.next=12;break}return F.a.success({content:"\u5220\u9664\u6210\u529f\uff0c\u5373\u5c06\u8df3\u8f6c\u81f3\u9996\u9875"}),this.props.index.deleteThreadsData({id:i},this.props.site),setTimeout((function(){g.a.push({url:"/"})}),1e3),e.abrupt("return");case 12:F.a.error({content:o});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onBtnClick",value:function(){this.delete(),this.setState({showDeletePopup:!1})}},{key:"onPublishClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p,h=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.length>0&&void 0!==h[0]?h[0]:"",n=h.length>1&&void 0!==h[1]?h[1]:[],t.replace(/\s/g,"")||0!==n.length){e.next=6;break}return F.a.info({content:"\u8bf7\u8f93\u5165\u5185\u5bb9"}),e.abrupt("return");case 6:if(i={val:t,imageList:n},!(a=this.props.site.webConfig)){e.next=21;break}if(c=null===a||void 0===a||null===(s=a.qcloud)||void 0===s?void 0:s.qcloudCaptcha,l=null===a||void 0===a||null===(o=a.other)||void 0===o?void 0:o.createThreadWithCaptcha,!c||!l){e.next=21;break}return e.next=14,this.props.showCaptcha();case 14:if(u=e.sent,d=u.captchaTicket,p=u.captchaRandStr,d||p){e.next=19;break}return e.abrupt("return",!1);case 19:i.captchaTicket=d,i.captchaRandStr=p;case 21:if(!this.comment){e.next=27;break}return e.next=24,this.updateComment(i);case 24:e.t0=e.sent,e.next=30;break;case 27:return e.next=29,this.createComment(i);case 29:e.t0=e.sent;case 30:return e.abrupt("return",e.t0);case 31:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createComment",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c,l,u,d,p,h,v,m,f,j,b,k,x,C,O;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.val,c=t.imageList,l=t.captchaTicket,u=void 0===l?"":l,d=t.captchaRandStr,p=void 0===d?"":d,h=null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i?void 0:i.id,v={id:h,content:o,sort:this.commentDataSort,isNoMore:null===(a=this.props)||void 0===a||null===(s=a.thread)||void 0===s?void 0:s.isNoMore,attachments:[],captchaTicket:u,captchaRandStr:p},null!==c&&void 0!==c&&c.length&&(v.attachments=c.filter((function(e){return"success"===e.status&&e.response})).map((function(e){return{id:e.response.id,type:"attachments"}}))),e.next=6,this.props.comment.createComment(v,this.props.thread);case 6:if(m=e.sent,f=m.success,j=m.msg,b=m.isApproved,k=m.redPacketAmount,!f){e.next=20;break}return this.props.thread.updatePostCount(this.props.thread.totalCount),this.props.thread.updateListStore(),(null===(x=this.props.thread)||void 0===x||null===(C=x.threadData)||void 0===C||null===(O=C.displayTag)||void 0===O?void 0:O.isRedPack)&&this.props.thread.fetchThreadDetail(h),k&&k>0&&this.props.thread.setRedPacket(k),b?F.a.success({content:j}):F.a.warning({content:j}),this.setState({showCommentInput:!1}),e.abrupt("return",!0);case 20:F.a.error({content:j});case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateComment",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c,l,u,d,p,h,v,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.val,s=t.captchaTicket,o=void 0===s?"":s,c=t.captchaRandStr,l=void 0===c?"":c,this.comment){e.next=3;break}return e.abrupt("return");case 3:return u=null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i?void 0:i.id,d={id:u,postId:this.comment.id,content:a,attachments:[],captchaTicket:o,captchaRandStr:l},e.next=7,this.props.comment.updateComment(d,this.props.thread);case 7:if(p=e.sent,h=p.success,v=p.msg,m=p.isApproved,!h){e.next=15;break}return m?F.a.success({content:v}):F.a.warning({content:v}),this.setState({showCommentInput:!1}),e.abrupt("return",!0);case 15:F.a.error({content:v});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEditClick",value:function(e){this.comment=e,this.setState({inputValue:e.content,showCommentInput:!0})}},{key:"onClose",value:function(){this.setState({showCommentInput:!1}),this.comment=null}},{key:"onLikeClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(B.a)({url:"/user/login"}),e.abrupt("return");case 4:return c=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,l={id:c,pid:null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.postId,isLiked:!(null!==(s=this.props.thread)&&void 0!==s&&null!==(o=s.threadData)&&void 0!==o&&o.isLike)},e.next=8,this.props.thread.updateLiked(l,this.props.index,this.props.user);case 8:u=e.sent,d=u.success,p=u.msg,d||F.a.error({content:p});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onShareClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(ce.a)()){e.next=2;break}return e.abrupt("return");case 2:return this.setState({isShowWeiXinShare:!0}),t=this.props.thread.threadData,n=t.id,e.next=7,this.props.thread.shareThread(n,this.props.index,this.props.search,this.props.topic);case 7:i=e.sent,a=i.success,s=i.msg,a||F.a.error({content:s});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onPayClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(B.a)({url:"/user/login"}),e.abrupt("return");case 4:return a=this.props.thread.threadData,e.next=7,Object(Y.a)(a,null===(t=this.props.user)||void 0===t?void 0:t.userInfo);case 7:if(s=e.sent,!s.success||null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i||!i.threadId){e.next=13;break}return e.next=12,this.props.thread.fetchThreadDetail(null===(o=this.props.thread)||void 0===o||null===(c=o.threadData)||void 0===c?void 0:c.threadId);case 12:this.props.thread.updateListStore();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onRewardClick",value:function(){if(!this.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});this.setState({showRewardPopup:!0})}},{key:"onRewardSubmit",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(isNaN(Number(t))||null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i||!i.threadId||null===(a=this.props.thread)||void 0===a||null===(s=a.threadData)||void 0===s||!s.userId){e.next=9;break}return this.setState({showRewardPopup:!1}),l={amount:Number(t),threadId:this.props.thread.threadData.threadId,payeeId:this.props.thread.threadData.userId,title:(null===(o=this.props.thread)||void 0===o||null===(c=o.threadData)||void 0===c?void 0:c.title)||"\u4e3b\u9898\u6253\u8d4f"},e.next=5,this.props.thread.rewardPay(l,this.props.user);case 5:u=e.sent,d=u.success,p=u.msg,d||F.a.error({content:p});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTagClick",value:function(){var e,t,n=null===(e=this.props.thread)||void 0===e||null===(t=e.threadData)||void 0===t?void 0:t.categoryId;(n||"number"===typeof n)&&this.props.index.refreshHomeData({categoryIds:[n]}),this.props.vlist.resetPosition(),g.a.push({url:"/cate/".concat(n,"/seq/0")})}},{key:"replyAvatarClick",value:function(e,t,n){if(2===n){var i=e.userId;if(!i)return;g.a.push({url:"/user/".concat(i)})}if(3===n){var a=e.commentUserId;if(!a)return;g.a.push({url:"/user/".concat(a)})}}},{key:"onUserClick",value:function(e){var t,n,i=(this.props.thread||{}).threadData;(null===i||void 0===i||null===(t=i.user)||void 0===t?void 0:t.userId)&&g.a.push({url:"/user/".concat(null===i||void 0===i||null===(n=i.user)||void 0===n?void 0:n.userId)})}},{key:"onLoadMoreClick",value:function(){this.props.commentPosition.page=this.props.commentPosition.page+1,this.loadCommentPositionList()}},{key:"loadCommentPositionList",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.props.commentPosition.isCommentReady,!this.state.isCommentLoading&&s){e.next=3;break}return e.abrupt("return");case 3:return this.setState({isCommentLoading:!0}),o=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,c={id:o,page:(null===(i=this.props)||void 0===i||null===(a=i.commentPosition)||void 0===a?void 0:a.page)||1,perPage:this.perPage,sort:this.commentDataSort?"createdAt":"-createdAt"},e.next=8,this.props.commentPosition.loadCommentList(c);case 8:if(l=e.sent,u=l.success,d=l.msg,this.setState({isCommentLoading:!1}),!u){e.next=14;break}return e.abrupt("return",!0);case 14:F.a.error({content:d});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,n,a,r,s,o,c,l,u,d,p,h,v,m,f,j,k,x=this,C=this.props.thread,O=C.isReady,y=C.isCommentReady,w=C.isNoMore,g=C.totalCount,P=C.isCommentListError,L=((null===C||void 0===C||null===(e=C.threadData)||void 0===e?void 0:e.content)||{}).indexes,E=Object(le.a)(L).RED_PACKET,M=0===(null===E||void 0===E?void 0:E.condition)&&(null===E||void 0===E?void 0:E.remainNumber)>0,F={moreClick:this.onMoreClick},B={canEdit:null===C||void 0===C||null===(t=C.threadData)||void 0===t||null===(n=t.ability)||void 0===n?void 0:n.canEdit,canDelete:null===C||void 0===C||null===(a=C.threadData)||void 0===a||null===(r=a.ability)||void 0===r?void 0:r.canDelete,canEssence:null===C||void 0===C||null===(s=C.threadData)||void 0===s||null===(o=s.ability)||void 0===o?void 0:o.canEssence,canStick:null===C||void 0===C||null===(c=C.threadData)||void 0===c||null===(l=c.ability)||void 0===l?void 0:l.canStick,canShare:this.props.user.isLogin(),canWxShare:this.props.user.isLogin()&&Object(ce.a)(),canCollect:this.props.user.isLogin(),isAdmini:null===(u=this.props)||void 0===u||null===(d=u.user)||void 0===d?void 0:d.isAdmini},z={isEssence:null===C||void 0===C||null===(p=C.threadData)||void 0===p||null===(h=p.displayTag)||void 0===h?void 0:h.isEssence,isStick:null===C||void 0===C||null===(v=C.threadData)||void 0===v?void 0:v.isStick,isCollect:null===C||void 0===C?void 0:C.isFavorite},J=1===((null===C||void 0===C||null===(m=C.threadData)||void 0===m?void 0:m.isApproved)||0),Q=this.props.commentPosition,Y=Q.isShowCommentList,Z=Q.isNoMore,$=this.props.site.webConfig;return Object(i.jsxs)("div",{className:N.a.container,children:[Object(i.jsxs)("div",{className:N.a.header,children:[Object(i.jsx)(V.a,{}),O&&!J&&Object(i.jsxs)("div",{className:N.a.examine,children:[Object(i.jsx)(T.a,{className:N.a.tipsIcon,name:"TipsOutlined"}),Object(i.jsx)("span",{className:N.a.tipsText,children:"\u5185\u5bb9\u6b63\u5728\u5ba1\u6838\u4e2d\uff0c\u5ba1\u6838\u901a\u8fc7\u540e\u624d\u80fd\u6b63\u5e38\u663e\u793a\uff01"})]})]}),Object(i.jsxs)("div",{className:N.a.body,ref:this.threadBodyRef,onScrollCapture:Object(G.a)((function(){return x.handleOnScroll()}),1e3),children:[Object(i.jsx)(U,{showContent:this.state.showContent,setTop:this.state.setTop}),O?Object(i.jsx)(Ie,{store:C,setContentImgReady:this.setContentImgReady,fun:F,onLikeClick:function(){return x.onLikeClick()},onOperClick:function(e){return x.onOperClick(e)},onCollectionClick:function(){return x.onCollectionClick()},onReportClick:function(){return x.onReportClick()},onRewardClick:function(){return x.onRewardClick()},onTagClick:function(){return x.onTagClick()},onPayClick:function(){return x.onPayClick()},onUserClick:function(e){return x.onUserClick(e)}}):Object(i.jsx)(S.a,{type:"init"}),$.setSite.siteComment[1].value&&Object(i.jsx)(i.Fragment,{children:O&&J&&Object(i.jsx)("div",{className:"".concat(N.a.bottom),ref:this.commentDataRef,children:y?Object(i.jsxs)(b.Fragment,{children:[y&&Y&&Object(i.jsxs)(b.Fragment,{children:[Object(i.jsx)(Ve,{isPositionComment:!0,sort:function(e){return x.onSortChange(e)},replyAvatarClick:function(e,t,n){return x.replyAvatarClick(e,t,n)}}),!Z&&Object(i.jsxs)("div",{className:N.a.showMore,onClick:function(){return x.onLoadMoreClick()},children:[Object(i.jsx)("div",{className:N.a.hidePercent,children:"\u5c55\u5f00\u66f4\u591a\u8bc4\u8bba"}),Object(i.jsx)(T.a,{className:N.a.icon,name:"RightOutlined",size:12})]})]}),Object(i.jsx)(Ve,{canPublish:this.props.canPublish,positionRef:this.positionRef,showHeader:!Y,sort:function(e){return x.onSortChange(e)},onEditClick:function(e){return x.onEditClick(e)},replyAvatarClick:function(e,t,n){return x.replyAvatarClick(e,t,n)}}),Object(i.jsx)(Be.a,{noMoreType:"line",isError:P,noMore:w})]}):Object(i.jsx)(S.a,{isError:P,type:"init"})})}),Object(i.jsx)(We.a,{marginTop:0})]}),O&&J&&Object(i.jsx)("div",{className:N.a.footerContainer,children:Object(i.jsxs)("div",{className:N.a.footer,children:[$.setSite.siteComment[1].value&&Object(i.jsxs)("div",{className:I()(R.a.inputClick,M&&R.a.hasHongbao),onClick:function(){return x.onInputClick()},children:[M&&Object(i.jsx)("img",{className:R.a.hongbaoMini,src:"https://cloudcache.tencentcs.com/operation/dianshi/other/redpacket-mini.10b46eefd630a5d5d322d6bbc07690ac4536ee2d.png"}),Object(i.jsx)(A.a,{className:R.a.input,placeholder:"\u5199\u8bc4\u8bba",disabled:!0,prefixIcon:"EditOutlined"})]}),Object(i.jsxs)("div",{className:R.a.operate,children:[Object(i.jsxs)("div",{className:R.a.icon,onClick:function(){return x.onMessageClick()},children:[this.state.stateFlag?g>0?Object(i.jsx)("div",{className:I()(R.a.badge,g<10&&R.a.isCricle),children:g>99?"99+":"".concat(g||"0")}):"":Object(i.jsx)("div",{className:R.a.content,children:"\u6b63\u6587"}),Object(i.jsx)(T.a,{size:"20",name:"MessageOutlined"})]}),Object(i.jsx)(T.a,{className:I()(R.a.icon,D()({},R.a.isliked,null===(f=this.props.thread)||void 0===f||null===(j=f.threadData)||void 0===j?void 0:j.isLike)),onClick:Object(K.a)((function(){return x.onLikeClick()}),500),size:"20",name:"LikeOutlined"}),Object(i.jsx)(T.a,{className:I()(R.a.icon,D()({},R.a.isliked,null===(k=this.props.thread)||void 0===k?void 0:k.isFavorite)),onClick:Object(K.a)((function(){return x.onCollectionClick()}),500),size:"20",name:"CollectOutlinedBig"}),Object(i.jsx)(T.a,{onClick:Object(X.a)((function(){return x.handleClick()}),1e3),className:R.a.icon,size:"20",name:"ShareAltOutlined"})]})]})}),Object(i.jsx)(ze.a,{show:this.state.show,onClose:this.onShareClose,handleH5Share:this.handleH5Share,handleWxShare:this.handleWxShare,createCard:this.createCard}),O&&Object(i.jsxs)(b.Fragment,{children:[Object(i.jsx)(H.a,{visible:this.state.showCommentInput,onClose:function(){return x.onClose()},initValue:this.state.inputValue,onSubmit:function(e,t){return x.onPublishClick(e,t)},site:this.props.site}),Object(i.jsx)(q.a,{permissions:B,statuses:z,visible:this.state.showMorePopup,onClose:function(){return x.setState({showMorePopup:!1})},onSubmit:function(){return x.setState({showMorePopup:!1})},onOperClick:function(e){return x.onOperClick(e)}}),Object(i.jsx)(_.a,{visible:this.state.showDeletePopup,onClose:function(){return x.setState({showDeletePopup:!1})},onBtnClick:function(e){return x.onBtnClick(e)},type:"thread"}),Object(i.jsx)(W.a,{reportContent:this.reportContent,inputText:this.inputText,visible:this.state.showReportPopup,onCancel:function(){return x.setState({showReportPopup:!1})},onOkClick:function(e){return x.onReportOk(e)}}),Object(i.jsx)(se,{visible:this.state.showRewardPopup,onCancel:function(){return x.setState({showRewardPopup:!1})},onOkClick:function(e){return x.onRewardSubmit(e)}}),this.state.loadWeiXin&&Object(i.jsx)(oe.a,{visible:this.state.isShowWeiXinShare,onClose:function(){return x.setState({isShowWeiXinShare:!1})},type:"thread"})]})]})}}]),n}(k.a.Component))||Fe)||Fe)||Fe)||Fe)||Fe)||Fe)||Fe)||Fe)||Fe,He=Object(Ee.a)(qe),Ge=n("JMpY"),Ke=n("iUiS"),Xe=n("E2V6"),Je=function(e){var t=e.visible,n=e.onOkClick,a=Object(b.useState)(""),s=a[0],c=a[1];Object(b.useEffect)((function(){c("")}),[t]);var l=function(){"function"===typeof(null===e||void 0===e?void 0:e.onCancel)&&e.onCancel()},u=function(){var e=o()(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(""===s||Number(s)<=0||Number(s)>1e6)){e.next=4;break}return(""===s||Number(s)<=0)&&F.a.error({content:"\u91d1\u989d\u4e0d\u80fd\u4e3a0"}),Number(s)>1e6&&F.a.error({content:"\u91d1\u989d\u4e0d\u80fd\u8d85\u8fc7100\u4e07"}),e.abrupt("return");case 4:if("function"!==typeof n){e.next=16;break}return e.prev=6,e.next=9,n(s);case 9:e.sent&&c(""),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(){return e.apply(this,arguments)}}();return Object(i.jsx)($.a,{position:"center",visible:t,onClose:l,children:Object(i.jsxs)("div",{className:Xe.a.container,children:[Object(i.jsxs)("div",{className:Xe.a.header,children:[Object(i.jsx)("div",{className:Xe.a.headerLeft,children:"\u652f\u4ed8\u4f5c\u8005\u7ee7\u7eed\u521b\u4f5c"}),Object(i.jsx)(T.a,{className:Xe.a.headerIcon,size:14,name:"CloseOutlined",onClick:l})]}),Object(i.jsxs)("div",{className:Xe.a.rewardInput,children:[Object(i.jsx)("span",{className:Xe.a.prepend,children:"\u652f\u4ed8\u91d1\u989d"}),Object(i.jsx)(A.a,{mode:"number",placeholder:"\u91d1\u989d",className:Xe.a.input,value:s,onChange:function(e){return function(e){var t=e.match(/([1-9]\d{0,6}|0)(\.\d{0,2})?/);c(t?t[0]:"")}(e.target.value)}}),Object(i.jsx)("span",{className:Xe.a.append,children:"\u5143"})]}),Object(i.jsx)("div",{className:Xe.a.rewardList,children:[1,2,5,10,20,50,88,128].map((function(e){return Object(i.jsxs)("div",{onClick:function(){return function(e){c(e)}(e)},className:I()(Xe.a.reward,Number(s)===e&&Xe.a.actived),children:["\uffe5",e]},e)}))}),Object(i.jsxs)("div",{className:Xe.a.button,children:[Object(i.jsx)(te.a,{onClick:l,className:Xe.a.cancel,type:"default",children:"\u53d6\u6d88"}),Object(i.jsx)(te.a,{onClick:u,className:Xe.a.ok,type:"primary",children:"\u786e\u5b9a"})]})]})})},Qe=n("INMq"),Ye=n("KimE"),Ze=n("2w7u"),$e=n("cjmN"),et=function(e){var t=e.showContent,n=e.setTop;return Object(i.jsxs)("div",{className:"".concat($e.a.setTop," ").concat(n?$e.a.inTop:$e.a.outTop),children:[Object(i.jsx)("span",{className:$e.a.setTopIcon,children:Object(i.jsx)(T.a,{className:$e.a.icon,name:"CheckOutlined"})}),t?"\u7f6e\u9876\u6210\u529f":"\u5df2\u53d6\u6d88\u7f6e\u9876"]})},tt=n("DT/J"),nt=function(e){var t=e.isShow;return Object(i.jsx)("div",{className:"".concat(tt.a.examine," ").concat(tt.a.setTop," ").concat(t?tt.a.inTop:tt.a.outTop),children:Object(i.jsxs)("div",{className:tt.a.innerTip,children:[Object(i.jsx)(T.a,{className:tt.a.tipsIcon,name:"TipsOutlined"}),Object(i.jsx)("span",{className:tt.a.tipsText,children:"\u5185\u5bb9\u6b63\u5728\u5ba1\u6838\u4e2d\uff0c\u5ba1\u6838\u901a\u8fc7\u540e\u624d\u80fd\u6b63\u5e38\u663e\u793a\uff01"})]})})},it=n("Wpw2"),at=n("7BN5"),rt=n("nfQ1"),st=n.n(rt),ot=n("wdPI"),ct=n("kBz5"),lt=Object(C.inject)("index","site","user","thread","plugin")(Object(C.observer)((function(e){var t,n,a,s,c,l,u,d,p,h,v,m,f,j,b,k,x,C,O,y,D,w,N,R,P,S,L,E,A,M,F,V,B,W,z,U,_,q,H,G,X,J,Q,Y,Z,$,ee,ne,ae,re,se,oe,ce,ke,ye,we,ge,Ne,Re,Pe,Ie,Se,Le,Te,Ee,Ae,Me,Fe,Ve,Be,We,ze,Ue,_e,qe=e.store,He=e.site,Ge=e.index,Ke=e.thread,Xe=e.user,Je=(null===qe||void 0===qe||null===(t=qe.threadData)||void 0===t?void 0:t.content)||{},Qe=Je.text,Ye=Je.indexes,Ze=null===qe||void 0===qe?void 0:qe.threadData,$e=Ze.parentCategoryName,et=Ze.categoryName,tt=qe.hasRedPacket,nt={postId:null===qe||void 0===qe||null===(n=qe.threadData)||void 0===n?void 0:n.postId,threadId:null===qe||void 0===qe||null===(a=qe.threadData)||void 0===a?void 0:a.threadId,platform:"pc",payType:null===qe||void 0===qe||null===(s=qe.threadData)||void 0===s?void 0:s.payType},it=1===((null===qe||void 0===qe||null===(c=qe.threadData)||void 0===c?void 0:c.isApproved)||0),at=0===(null===qe||void 0===qe||null===(l=qe.threadData)||void 0===l?void 0:l.payType),rt=(null===qe||void 0===qe||null===(u=qe.threadData)||void 0===u||null===(d=u.displayTag)||void 0===d?void 0:d.isEssence)||!1,lt=(null===qe||void 0===qe||null===(p=qe.threadData)||void 0===p||null===(h=p.displayTag)||void 0===h?void 0:h.isPoster)||!1,ut=null===qe||void 0===qe||null===(v=qe.threadData)||void 0===v?void 0:v.isStick,dt=null===qe||void 0===qe||null===(m=qe.threadData)||void 0===m||null===(f=m.ability)||void 0===f?void 0:f.canEdit,pt=null===qe||void 0===qe||null===(j=qe.threadData)||void 0===j||null===(b=j.ability)||void 0===b?void 0:b.canDelete,ht=null===qe||void 0===qe||null===(k=qe.threadData)||void 0===k||null===(x=k.ability)||void 0===x?void 0:x.canEssence,vt=null===qe||void 0===qe||null===(C=qe.threadData)||void 0===C||null===(O=C.ability)||void 0===O?void 0:O.canPoster,mt=null===qe||void 0===qe||null===(y=qe.threadData)||void 0===y||null===(D=y.ability)||void 0===D?void 0:D.canStick,ft=(null===(w=e.user)||void 0===w||null===(N=w.userInfo)||void 0===N?void 0:N.id)&&(null===(R=e.user)||void 0===R||null===(P=R.userInfo)||void 0===P?void 0:P.id)===(null===qe||void 0===qe||null===(S=qe.threadData)||void 0===S?void 0:S.userId),jt=!0===(null===qe||void 0===qe||null===(L=qe.threadData)||void 0===L?void 0:L.paid),bt=null===qe||void 0===qe||null===(E=qe.threadData)||void 0===E?void 0:E.ability.canFreeViewPost,kt=2===(null===qe||void 0===qe||null===(A=qe.threadData)||void 0===A?void 0:A.payType)&&!1===(null===qe||void 0===qe||null===(M=qe.threadData)||void 0===M?void 0:M.paid),xt=(null===qe||void 0===qe||null===(F=qe.threadData)||void 0===F?void 0:F.attachmentPrice)||0,Ct=!bt&&kt&&!ft&&!jt,Ot=1===(null===qe||void 0===qe||null===(V=qe.threadData)||void 0===V?void 0:V.payType),yt=(null===qe||void 0===qe||null===(B=qe.threadData)||void 0===B?void 0:B.price)||0,Dt=null===qe||void 0===qe||null===(W=qe.threadData)||void 0===W||null===(z=W.displayTag)||void 0===z?void 0:z.isRedPack,wt=null===qe||void 0===qe||null===(U=qe.threadData)||void 0===U||null===(_=U.displayTag)||void 0===_?void 0:_.isReward,gt=(at&&(null===qe||void 0===qe||null===(q=qe.threadData)||void 0===q||q.ability.canBeReward),null===qe||void 0===qe||null===(H=qe.threadData)||void 0===H||H.isReward,Object(le.a)(Ye));Xe.isLogin()&&it&&1===(null===(G=gt.RED_PACKET)||void 0===G?void 0:G.condition)&&qe.getRedPacketInfo(gt.RED_PACKET.threadId);var Nt=function(){var t=o()(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"function"===typeof e.onPayClick&&e.onPayClick();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Rt=function(e){e&&window.open(e)},Pt=function(t){"function"===typeof e.onOperClick&&e.onOperClick(t)},It=(null===qe||void 0===qe||null===(X=qe.threadData)||void 0===X?void 0:X.ability)||{},St=It.canDownloadAttachment,Lt=It.canViewAttachment,Tt=It.canViewVideo,Et=(null===qe||void 0===qe?void 0:qe.threadData)||{},At=Et.tipList,Mt=Et.isAnonymous;return Object(i.jsxs)("div",{className:"".concat(ot.a.container),children:[Object(i.jsxs)("div",{className:ot.a.header,children:[Object(i.jsx)("div",{className:ot.a.userInfo,children:Object(i.jsx)(be.a,{name:(null===qe||void 0===qe||null===(J=qe.threadData)||void 0===J||null===(Q=J.user)||void 0===Q?void 0:Q.nickname)||"",avatar:(null===qe||void 0===qe||null===(Y=qe.threadData)||void 0===Y||null===(Z=Y.user)||void 0===Z?void 0:Z.avatar)||"",groupName:Mt?"":(null===qe||void 0===qe||null===($=qe.threadData)||void 0===$||null===(ee=$.group)||void 0===ee?void 0:ee.groupName)||"",groupLevel:(null===qe||void 0===qe||null===(ne=qe.threadData)||void 0===ne||null===(ae=ne.group)||void 0===ae?void 0:ae.level)||0,location:(null===qe||void 0===qe||null===(re=qe.threadData)||void 0===re?void 0:re.position.location)||"",view:"".concat(null===qe||void 0===qe||null===(se=qe.threadData)||void 0===se?void 0:se.viewCount)||"",time:"".concat(null===qe||void 0===qe||null===(oe=qe.threadData)||void 0===oe?void 0:oe.diffTime)||"",userId:null===qe||void 0===qe||null===(ce=qe.threadData)||void 0===ce||null===(ke=ce.user)||void 0===ke?void 0:ke.userId,isEssence:rt,isPoster:lt,isPay:!at,isReward:wt,isRed:Dt,hideInfoPopip:!0,platform:"pc",onClick:function(t){t&&t.stopPropagation(),"function"===typeof e.onUserClick&&e.onUserClick()}})}),(null===e||void 0===e||null===(ye=e.user)||void 0===ye?void 0:ye.isLogin())&&Object(i.jsxs)("div",{className:ot.a.more,children:[(rt||lt||!at||wt||Dt)&&Object(i.jsx)(ie.a,{mode:"vertical",className:ot.a.moreDivider}),it&&(dt||mt||ht||vt||pt)&&Object(i.jsx)("div",{className:ot.a.iconText,children:Object(i.jsxs)(st.a,{menu:Object(i.jsxs)(st.a.Menu,{children:[dt&&Object(i.jsx)(st.a.Item,{id:"edit",children:"\u7f16\u8f91"}),mt&&Object(i.jsx)(st.a.Item,{id:"stick",children:ut?"\u53d6\u6d88\u7f6e\u9876":"\u7f6e\u9876"}),ht&&Object(i.jsxs)(st.a.Item,{id:"essence",children:[" ",rt?"\u53d6\u6d88\u7cbe\u534e":"\u7cbe\u534e"]}),vt&&Object(i.jsxs)(st.a.Item,{id:"poster",children:[" ",lt?"\u53d6\u6d88\u6d77\u62a5":"\u6d77\u62a5"]}),pt&&Object(i.jsx)(st.a.Item,{id:"delete",children:"\u5220\u9664"})]}),placement:"center",hideOnClick:!0,arrow:!1,trigger:"hover",onChange:function(e){return Pt(e)},children:[Object(i.jsx)(T.a,{className:ot.a.icon,name:"SettingOutlined"}),Object(i.jsx)("span",{className:ot.a.text,children:"\u7ba1\u7406"})]})}),!(null!==e&&void 0!==e&&null!==(we=e.user)&&void 0!==we&&we.isAdmini)&&Object(i.jsxs)("div",{className:I()(ot.a.iconText,(null===e||void 0===e||null===(ge=e.user)||void 0===ge?void 0:ge.isAdmini)&&ot.a.disabled),onClick:function(){return Pt("report")},children:[Object(i.jsx)(T.a,{className:ot.a.icon,name:"WarnOutlinedThick"}),Object(i.jsx)("span",{className:ot.a.text,children:"\u4e3e\u62a5"})]})]})]}),Object(i.jsx)(ie.a,{className:ot.a.divider}),Object(i.jsxs)("div",{className:ot.a.body,children:[(null===qe||void 0===qe||null===(Ne=qe.threadData)||void 0===Ne?void 0:Ne.title)&&Object(i.jsx)("div",{className:ot.a.title,children:null===qe||void 0===qe||null===(Re=qe.threadData)||void 0===Re?void 0:Re.title}),Qe&&Object(i.jsx)(pe.a,{needShowMore:!1,content:Qe||"",usePointer:!1}),gt.VIDEO&&1!==gt.VIDEO.needPay&&Object(i.jsx)(ve.a,{url:gt.VIDEO.mediaUrl,coverUrl:gt.VIDEO.coverUrl,v_width:gt.VIDEO.width||null,v_height:gt.VIDEO.height||null,status:gt.VIDEO.status,canViewVideo:Tt}),gt.IFRAME&&Object(i.jsx)(xe.a,{content:gt.IFRAME.content}),gt.IMAGE&&Object(i.jsx)(ue.a,{flat:!0,platform:"pc",isPay:Ct,onPay:Nt,imgData:gt.IMAGE}),(gt.RED_PACKET||gt.REWARD)&&Object(i.jsxs)("div",{className:ot.a.reward,style:{width:"100%"},children:[He.webConfig.setSite.siteAreward[0].value&&Object(i.jsx)(i.Fragment,{children:gt.REWARD&&Object(i.jsxs)("div",{className:ot.a.rewardBody,style:{width:"100%"},children:[Object(i.jsx)(Oe.a,{type:1,money:gt.REWARD.money,remainMoney:gt.REWARD.remainMoney}),Object(i.jsxs)("div",{className:ot.a.rewardMoney,children:["\u672c\u5e16\u5411\u6240\u6709\u4eba\u60ac\u8d4f",Object(i.jsx)("span",{className:ot.a.rewardNumber,children:gt.REWARD.money||0}),"\u5143"]}),Object(i.jsxs)("div",{className:ot.a.rewardTime,children:[gt.REWARD.expiredAt,"\u622a\u6b62\u60ac\u8d4f"]})]})}),He.webConfig.setSite.siteRedpacket[0].value&&Object(i.jsx)(i.Fragment,{children:gt.RED_PACKET&&Object(i.jsxs)("div",{style:{width:"100%"},children:[Object(i.jsx)(Oe.a,{number:gt.RED_PACKET.number,remainNumber:gt.RED_PACKET.remainNumber,condition:gt.RED_PACKET.condition}),!!gt.RED_PACKET.condition&&Object(i.jsxs)("div",{className:ot.a.redPacketLikeNum,children:["\u8bc4\u8bba\u96c6",gt.RED_PACKET.likenum,"\u8d5e\u9886\u7ea2\u5305"]})]})})]}),He.webConfig.setSite.siteShop[0].value&&Object(i.jsx)(i.Fragment,{children:gt.GOODS&&Object(i.jsxs)("div",{className:ot.a.goods,children:[Object(i.jsx)(he.a,{image:null===gt||void 0===gt||null===(Pe=gt.GOODS)||void 0===Pe?void 0:Pe.imagePath,amount:null===gt||void 0===gt||null===(Ie=gt.GOODS)||void 0===Ie?void 0:Ie.price,title:null===gt||void 0===gt||null===(Se=gt.GOODS)||void 0===Se?void 0:Se.title,onClick:function(){return Rt(gt.GOODS.detailContent)}}),Object(i.jsx)(te.a,{className:ot.a.buyBtn,type:"danger",onClick:function(){return Rt(gt.GOODS.detailContent)},children:Object(i.jsxs)("div",{className:ot.a.buyContent,children:[Object(i.jsx)(T.a,{className:ot.a.buyIcon,name:"ShoppingCartOutlined",size:20}),Object(i.jsx)("span",{className:ot.a.buyText,children:"\u8d2d\u4e70\u5546\u54c1"})]})})]})}),gt.VOICE&&Object(i.jsx)(de.a,{url:gt.VOICE.mediaUrl}),gt.VOTE&&Object(i.jsx)(je.a,{attachments:gt.VOTE,threadId:null===qe||void 0===qe||null===(Le=qe.threadData)||void 0===Le?void 0:Le.threadId,canViewAttachment:Lt,canDownloadAttachment:St}),gt.VOTE_THREAD&&Object(i.jsx)(me.a,{voteData:gt.VOTE_THREAD,threadId:null===qe||void 0===qe||null===(Te=qe.threadData)||void 0===Te?void 0:Te.threadId,page:"detail"}),Object(i.jsx)(De.default,{target:"plugin_detail",hookName:"thread_extension_display_hook",pluginProps:{threadData:null===qe||void 0===qe?void 0:qe.threadData,renderData:gt.plugin,updateListThreadIndexes:Ge.updateListThreadIndexes.bind(Ge),updateThread:Ke.updateThread.bind(Ke)}}),He.webConfig.setSite.sitePay[0].value&&Object(i.jsx)(i.Fragment,{children:Ct&&Object(i.jsx)("div",{style:{textAlign:"center"},onClick:Nt,children:Object(i.jsx)(te.a,{className:ot.a.payButton,type:"primary",size:"large",children:Object(i.jsxs)("div",{className:ot.a.pay,children:[Object(i.jsx)(T.a,{className:ot.a.payIcon,name:"GoldCoinOutlined",size:18}),"\u652f\u4ed8",xt,"\u5143\u67e5\u770b\u4ed8\u8d39\u5185\u5bb9"]})})})}),($e||et)&&Object(i.jsx)("div",{className:ot.a.tag,onClick:function(){"function"===typeof e.onTagClick&&e.onTagClick()},children:$e?"".concat($e,"/").concat(et):et}),He.webConfig.setSite.sitePay[0].value&&Object(i.jsx)(i.Fragment,{children:!bt&&Ot&&!ft&&!jt&&Object(i.jsx)("div",{style:{textAlign:"center"},onClick:Nt,children:Object(i.jsx)(te.a,{className:ot.a.payButton,type:"primary",size:"large",children:Object(i.jsxs)("div",{className:ot.a.pay,children:[Object(i.jsx)(T.a,{className:ot.a.payIcon,name:"GoldCoinOutlined",size:18}),"\u652f\u4ed8",yt,"\u5143\u67e5\u770b\u5269\u4f59\u5185\u5bb9"]})})})}),He.webConfig.setSite.siteRewards[0].value&&Object(i.jsx)("div",{className:ot.a.rewardButton,children:Object(i.jsx)(te.a,{onClick:function(){"function"===typeof e.onRewardClick&&e.onRewardClick()},className:ot.a.rewardButton,type:"primary",size:"large",children:Object(i.jsxs)("div",{className:ot.a.buttonIconText,children:[Object(i.jsx)(T.a,{className:ot.a.buttonIcon,name:"HeartOutlined",size:19}),Object(i.jsx)("span",{className:ot.a.buttonText,children:"\u6253\u8d4f"})]})})}),At&&At.length>0&&Object(i.jsxs)("div",{className:ot.a.moneyList,children:[Object(i.jsxs)("div",{className:ot.a.top,children:[At.length,"\u4eba\u6253\u8d4f"]}),Object(i.jsx)("div",{className:ot.a.itemList,children:At.map((function(e){return Object(i.jsx)("div",{onClick:function(){return g.a.push({url:"/user/".concat(e.userId)})},className:ot.a.itemAvatar,children:Object(i.jsx)(Ce.a,{image:e.avatar,name:e.nickname,size:"small"})},e.userId)}))})]})]}),Object(i.jsxs)("div",{className:ot.a.footer,children:[Object(i.jsxs)("div",{className:ot.a.thumbs,children:[Object(i.jsx)("div",{className:ot.a.likeReward,children:Object(i.jsx)(fe.a,{tipData:nt,imgs:(null===qe||void 0===qe||null===(Ee=qe.threadData)||void 0===Ee||null===(Ae=Ee.likeReward)||void 0===Ae?void 0:Ae.users)||[],showCount:10,platform:"pc"})}),Object(i.jsx)("span",{children:(null===qe||void 0===qe||null===(Me=qe.threadData)||void 0===Me||null===(Fe=Me.likeReward)||void 0===Fe?void 0:Fe.likePayCount)||""})]}),(null===qe||void 0===qe||null===(Ve=qe.threadData)||void 0===Ve||null===(Be=Ve.likeReward)||void 0===Be?void 0:Be.shareCount)>0&&Object(i.jsxs)("span",{className:ot.a.share,children:[null===qe||void 0===qe||null===(We=qe.threadData)||void 0===We||null===(ze=We.likeReward)||void 0===ze?void 0:ze.shareCount,"\u6b21\u5206\u4eab"]})]}),Object(i.jsx)(ie.a,{className:ot.a.divider}),it&&Object(i.jsxs)("div",{className:ot.a.bottomOperate,children:[Object(i.jsxs)("div",{className:I()(ot.a.item,(null===qe||void 0===qe||null===(Ue=qe.threadData)||void 0===Ue?void 0:Ue.isLike)&&ot.a.active),onClick:Object(K.a)((function(){"function"===typeof e.onLikeClick&&e.onLikeClick()}),500),children:[Object(i.jsx)(T.a,{name:"LikeOutlined"}),Object(i.jsx)("span",{children:"\u8d5e"})]}),Object(i.jsxs)("div",{className:I()(ot.a.item,(null===qe||void 0===qe||null===(_e=qe.threadData)||void 0===_e?void 0:_e.isFavorite)&&ot.a.active),onClick:Object(K.a)((function(){"function"===typeof e.onCollectionClick&&e.onCollectionClick()}),500),children:[Object(i.jsx)(T.a,{name:"CollectOutlined"}),Object(i.jsx)("span",{children:"\u6536\u85cf"})]}),Object(i.jsxs)("div",{className:I()(ot.a.item),onClick:Object(K.a)((function(){"function"===typeof e.onShareClick&&e.onShareClick()}),500),children:[Object(i.jsx)(T.a,{name:"ShareAltOutlined"}),Object(i.jsx)("span",{children:"\u5206\u4eab"})]})]}),tt>0&&Object(i.jsx)(ct.a,{onClose:function(){return qe.setRedPacket(0)},money:tt})]})}))),ut=(n("T63A"),n("tkto"),n("J4zp")),dt=n.n(ut),pt=n("TciF"),ht=n("/c/8"),vt=n("PuBq");function mt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=j()(e);if(t){var a=j()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return m()(this,n)}}var ft={101:"IMAGE",102:"VOICE",103:"VIDEO",104:"GOODS",105:"QA",106:"RED_PACKET",107:"REWARD",108:"VOTE",109:"QUEUE",110:"FILE",111:"QA_IMAGE"},jt=Object(C.inject)("thread")(_e=Object(C.inject)("comment")(_e=Object(C.inject)("commentPosition")(_e=Object(C.inject)("user")(_e=Object(C.inject)("site")(_e=Object(C.observer)(_e=function(e){h()(n,e);var t=mt(n);function n(e){var i;return l()(this,n),(i=t.call(this,e)).onSortClick=function(){i.setState({commentSort:!i.state.commentSort}),"function"===typeof i.props.sort&&i.props.sort(!i.state.commentSort)},i.state={showAboptPopup:!1,showCommentInput:!1,commentSort:!0,showDeletePopup:!1,showReplyDeletePopup:!1,placeholder:"\u5199\u4e0b\u6211\u7684\u8bc4\u8bba...",commentId:null},i.comment10Ref=k.a.createRef(),i.commentData=null,i.replyData=null,i}return d()(n,[{key:"componentDidMount",value:function(){var e,t;null!==(e=this.props)&&void 0!==e&&null!==(t=e.thread)&&void 0!==t&&t.isPositionToComment&&this.comment10Ref.current&&this.comment10Ref.current.scrollIntoView()}},{key:"likeClick",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(B.a)({url:"/user/login"}),e.abrupt("return");case 4:if(t.id){e.next=6;break}return e.abrupt("return");case 6:return n={id:t.id,isLiked:!t.isLiked},e.next=9,this.props.comment.updateLiked(n,this.props.thread);case 9:i=e.sent,a=i.success,s=i.msg,a&&(this.props.isPositionComment?(this.props.commentPosition.setCommentListDetailField(t.id,"isLiked",n.isLiked),o=n.isLiked?t.likeCount+1:t.likeCount-1,this.props.commentPosition.setCommentListDetailField(t.id,"likeCount",o)):(this.props.thread.setCommentListDetailField(t.id,"isLiked",n.isLiked),c=n.isLiked?t.likeCount+1:t.likeCount-1,this.props.thread.setCommentListDetailField(t.id,"likeCount",c))),a||F.a.error({content:s});case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replyLikeClick",value:function(){var e=o()(r.a.mark((function e(t,n){var i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(B.a)({url:"/user/login"}),e.abrupt("return");case 4:if(t.id){e.next=6;break}return e.abrupt("return");case 6:return i={id:t.id,isLiked:!t.isLiked},e.next=9,this.props.comment.updateLiked(i);case 9:a=e.sent,s=a.success,o=a.msg,s&&(this.props.isPositionComment?(this.props.commentPosition.setReplyListDetailField(n.id,t.id,"isLiked",i.isLiked),c=i.isLiked?t.likeCount+1:t.likeCount-1,this.props.commentPosition.setReplyListDetailField(n.id,t.id,"likeCount",c)):(this.props.thread.setReplyListDetailField(n.id,t.id,"isLiked",i.isLiked),l=i.isLiked?t.likeCount+1:t.likeCount-1,this.props.thread.setReplyListDetailField(n.id,t.id,"likeCount",l))),s||F.a.error({content:o});case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteClick",value:function(){var e=o()(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(B.a)({url:"/user/login"}),e.abrupt("return");case 4:this.commentData=t,this.setState({showDeletePopup:!0});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteComment",value:function(){var e=o()(r.a.mark((function e(){var t,n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(B.a)({url:"/user/login"}),e.abrupt("return");case 4:if(this.commentData.id){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this.props.comment.delete(this.commentData.id,this.props.isPositionComment?this.props.commentPosition:this.props.thread);case 8:if(t=e.sent,n=t.success,i=t.msg,this.setState({showDeletePopup:!1}),!n){e.next=15;break}return F.a.success({content:"\u5220\u9664\u6210\u529f"}),e.abrupt("return");case 15:F.a.error({content:i});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"replyDeleteClick",value:function(){var e=o()(r.a.mark((function e(t,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.commentData=n,this.replyData=t,this.setState({showReplyDeletePopup:!0});case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"replyDeleteComment",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.replyData.id){e.next=2;break}return e.abrupt("return");case 2:return t={},this.replyData&&this.commentData&&(t.replyData=this.replyData,t.commentData=this.commentData),e.next=6,this.props.comment.deleteReplyComment(t,this.props.isPositionComment?this.props.commentPosition:this.props.thread);case 6:if(n=e.sent,i=n.success,a=n.msg,this.setState({showReplyDeletePopup:!1}),!i){e.next=13;break}return F.a.success({content:"\u5220\u9664\u6210\u529f"}),e.abrupt("return");case 13:F.a.error({content:a});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"replyClick",value:function(e){if(!this.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});this.props.canPublish("reply")&&(this.commentData=e,this.replyData=null,this.setState({showCommentInput:!0,commentId:e.id}))}},{key:"replyReplyClick",value:function(e,t){if(!this.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});this.props.canPublish("reply")&&(this.commentData=null,this.replyData=e,this.replyData.commentId=t.id,this.setState({showCommentInput:!0,commentId:null}))}},{key:"createReply",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p,h,v,m,f,j,b,k,x=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=x.length>0&&void 0!==x[0]?x[0]:"",a=x.length>1&&void 0!==x[1]?x[1]:[],i.replace(/\s/g,"")||0!==a.length){e.next=6;break}return F.a.info({content:"\u8bf7\u8f93\u5165\u5185\u5bb9"}),e.abrupt("return");case 6:if(s=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id){e.next=9;break}return e.abrupt("return");case 9:if(o={id:s,content:i},this.replyData&&(o.replyId=this.replyData.id,o.isComment=!0,o.commentId=this.replyData.commentId,o.commentPostId=this.replyData.id),this.commentData&&(o.replyId=this.commentData.id,o.isComment=!0,o.commentId=this.commentData.id),null!==a&&void 0!==a&&a.length&&(o.attachments=a.filter((function(e){return"success"===e.status&&e.response})).map((function(e){return{id:e.response.id,type:"attachments"}}))),!(c=this.props.site.webConfig)){e.next=27;break}if(d=null===c||void 0===c||null===(l=c.qcloud)||void 0===l?void 0:l.qcloudCaptcha,p=null===c||void 0===c||null===(u=c.other)||void 0===u?void 0:u.createThreadWithCaptcha,!d||!p){e.next=27;break}return e.next=20,this.props.showCaptcha();case 20:if(h=e.sent,v=h.captchaTicket,m=h.captchaRandStr,v||m){e.next=25;break}return e.abrupt("return",!1);case 25:o.captchaTicket=v,o.captchaRandStr=m;case 27:return e.next=29,this.props.comment.createReply(o,this.props.isPositionComment?this.props.commentPosition:this.props.thread);case 29:if(f=e.sent,j=f.success,b=f.msg,k=f.isApproved,!j){e.next=37;break}return this.setState({showCommentInput:!1,inputValue:"",commentId:null}),k?F.a.success({content:b}):F.a.warning({content:b}),e.abrupt("return",!0);case 37:F.a.error({content:b});case 38:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"editClick",value:function(e){"function"===typeof this.props.onEditClick&&this.props.onEditClick(e)}},{key:"onCommentClick",value:function(e){var t,n,i,a;e.id&&null!==(t=this.props.thread)&&void 0!==t&&null!==(n=t.threadData)&&void 0!==n&&n.id&&this.props.router.push("/thread/comment/".concat(e.id,"?threadId=").concat(null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.id))}},{key:"onAboptClick",value:function(e){if(!this.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});this.commentData=e,this.setState({showAboptPopup:!0})}},{key:"onAboptOk",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>0)){e.next=15;break}return a={postId:this.commentData.id,rewards:t,threadId:null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i?void 0:i.threadId},e.next=4,this.props.thread.reward(a);case 4:if(s=e.sent,o=s.success,c=s.msg,!o){e.next=12;break}return this.setState({showAboptPopup:!1}),this.props.thread.fetchThreadDetail(a.threadId),F.a.success({content:"\u60ac\u8d4f".concat(t,"\u5143")}),e.abrupt("return",!0);case 12:F.a.error({content:c}),e.next=16;break;case 15:F.a.info({content:"\u60ac\u8d4f\u91d1\u989d\u4e0d\u80fd\u4e3a0"});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onAboptCancel",value:function(){this.commentData=null,this.setState({showAboptPopup:!1})}},{key:"onUserClick",value:function(e){e&&g.a.push({url:"/user/".concat(e)})}},{key:"reportClick",value:function(e){"function"===typeof this.props.onReportClick&&this.props.onReportClick(e)}},{key:"replyAvatarClick",value:function(e,t,n){if(2===n){var i=e.userId;if(!i)return;this.props.router.push("/user/".concat(i))}if(3===n){var a=e.commentUserId;if(!a)return;this.props.router.push("/user/".concat(a))}}},{key:"onFocus",value:function(e){return this.props.user.isLogin()?!!this.props.canPublish("reply")||void 0:(e&&e.stopPropagation(),F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"}))}},{key:"render",value:function(){var e,t,n,a,r,s,o,c,l,u,d,p,h,v,m=this,f=this.props.thread,j=f.totalCount,b=f.commentList,k=this.props.commentPosition,x=k.commentList,C=k.postId;this.props.isPositionComment&&(b=x||[]);var O=(null===(e=this.props.user)||void 0===e||null===(t=e.userInfo)||void 0===t?void 0:t.id)&&(null===(n=this.props.user)||void 0===n||null===(a=n.userInfo)||void 0===a?void 0:a.id)===(null===(r=this.props.thread)||void 0===r||null===(s=r.threadData)||void 0===s?void 0:s.userId),y=null===(o=this.props.thread)||void 0===o||null===(c=o.threadData)||void 0===c||null===(l=c.displayTag)||void 0===l?void 0:l.isReward,D=((null===(u=this.props.thread)||void 0===u?void 0:u.threadData)||"").isAnonymous,w=((null===(d=this.props.thread)||void 0===d||null===(p=d.threadData)||void 0===p?void 0:p.content)||{}).indexes,g={};w&&Object.keys(w)&&Object.entries(w).forEach((function(e){var t=dt()(e,2)[1];if(t){var n=t.tomId,i=t.body;g[ft[n]]=i}}));var N=Object(le.a)(w).RED_PACKET,R=0===(null===N||void 0===N?void 0:N.condition)&&(null===N||void 0===N?void 0:N.remainNumber)>0;return Object(i.jsxs)("div",{className:I()(pt.a.container,!j&&pt.a.isEmpty),children:[this.props.showHeader&&Object(i.jsxs)("div",{className:pt.a.header,children:[j?Object(i.jsxs)("div",{className:pt.a.number,children:[j,"\u6761\u8bc4\u8bba"]}):Object(i.jsx)("div",{className:pt.a.number,children:"\u6682\u65e0\u8bc4\u8bba"}),Object(i.jsxs)("div",{className:pt.a.sort,onClick:function(){return m.onSortClick()},children:[Object(i.jsx)(T.a,{className:pt.a.sortIcon,name:"SortOutlined",size:14}),Object(i.jsx)("span",{className:pt.a.sortText,children:this.state.commentSort?"\u8bc4\u8bba\u4ece\u65b0\u5230\u65e7":"\u8bc4\u8bba\u4ece\u65e7\u5230\u65b0"})]})]}),this.props.showHeader&&Object(i.jsx)("div",{className:pt.a.input,children:Object(i.jsx)(Ke.a,{height:"middle",onSubmit:function(e,t){return m.props.onPublishClick(e,t)},initValue:this.state.inputValue,placeholder:this.state.placeholder,onFocus:function(e){return m.onFocus(e)},onEmojiIconClick:function(){return m.onFocus()},onAtIconClick:function(){return m.onFocus()},onPcitureIconClick:function(){return m.onFocus()},hasHongbao:R})}),Object(i.jsx)("div",{className:pt.a.body,children:b.map((function(e,t){var n,a;return Object(i.jsx)("div",{className:"".concat(pt.a.commentItems," ").concat(t===b.length-1&&pt.a.isLastOne),ref:e.id===C?m.props.positionRef:null,children:Object(i.jsx)("div",{ref:10===t?m.comment10Ref:null,children:Object(i.jsx)(vt.a,{data:e,avatarClick:function(e){return m.onUserClick(e)},replyAvatarClick:function(t,n){return m.replyAvatarClick(t,e,n)},likeClick:function(){return m.likeClick(e)},replyClick:function(){return m.replyClick(e)},deleteClick:function(){return m.deleteClick(e)},editClick:function(){return m.editClick(e)},replyLikeClick:function(t){return m.replyLikeClick(t,e)},replyReplyClick:function(t){return m.replyReplyClick(t,e)},replyDeleteClick:function(t){return m.replyDeleteClick(t,e)},reportClick:function(){return m.reportClick(e)},onCommentClick:function(){return m.onCommentClick(e)},onSubmit:function(e,t){return m.createReply(e,t)},isShowOne:!0,isShowInput:m.state.commentId===e.id,onAboptClick:function(){return m.onAboptClick(e)},isShowAdopt:O&&y&&(null===(n=m.props.thread)||void 0===n||null===(a=n.threadData)||void 0===a?void 0:a.userId)!==e.userId,redPacketData:N,thread:m.props.thread,threadId:m.props.thread.threadData.userId,active:e.id===C,isAnonymous:D},e.id)})},e.id||t)}))}),Object(i.jsx)(_.a,{visible:this.state.showDeletePopup,onClose:function(){return m.setState({showDeletePopup:!1})},onBtnClick:function(){return m.deleteComment()}}),Object(i.jsx)(_.a,{visible:this.state.showReplyDeletePopup,onClose:function(){return m.setState({showReplyDeletePopup:!1})},onBtnClick:function(){return m.replyDeleteComment()}}),(null===g||void 0===g||null===(h=g.REWARD)||void 0===h?void 0:h.money)&&(null===g||void 0===g||null===(v=g.REWARD)||void 0===v?void 0:v.remainMoney)&&Object(i.jsx)(ht.a,{money:Number(g.REWARD.money),remainMoney:Number(g.REWARD.remainMoney),visible:this.state.showAboptPopup,onCancel:function(){return m.onAboptCancel()},onOkClick:function(e){return m.onAboptOk(e)}})]})}}]),n}(k.a.Component))||_e)||_e)||_e)||_e)||_e)||_e;jt.defaultProps={showHeader:!0};var bt,kt=Object(Ee.a)(jt);function xt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=j()(e);if(t){var a=j()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return m()(this,n)}}var Ct,Ot=Object(C.inject)("site")(bt=Object(C.inject)("user")(bt=Object(C.inject)("thread")(bt=Object(C.inject)("commentPosition")(bt=Object(C.inject)("comment")(bt=Object(C.inject)("index")(bt=Object(C.observer)(bt=function(e){h()(n,e);var t=xt(n);function n(e){var i;return l()(this,n),(i=t.call(this,e)).state={showReportPopup:!1,showDeletePopup:!1,showCommentInput:!1,showMorePopup:!1,showRewardPopup:!1,isCommentLoading:!1,setTop:!1,inputValue:"",isBaseLayoutReady:!1},i.likedLoading=!1,i.collectLoading=!1,i.perPage=20,i.page=1,i.commentDataSort=!0,i.threadBodyRef=k.a.createRef(),i.commentDataRef=k.a.createRef(),i.position=0,i.comment=null,i.reportContent=["\u5e7f\u544a\u5783\u573e","\u8fdd\u89c4\u5185\u5bb9","\u6076\u610f\u704c\u6c34","\u91cd\u590d\u53d1\u5e16"],i.inputText="\u8bf7\u8f93\u5165\u5176\u4ed6\u7406\u7531",i.positionRef=k.a.createRef(),i.isPositioned=!1,i}return d()(n,[{key:"handleOnRefresh",value:function(){return this.props.thread.setCommentListPage(this.props.thread.page+1),this.loadCommentList()}},{key:"handleOnScroll",value:function(){var e,t,n,i,a=null===(e=this.threadBodyRef)||void 0===e||null===(t=e.current)||void 0===t||null===(n=t.listRef)||void 0===n||null===(i=n.current)||void 0===i?void 0:i.listWrapper;if(a&&a.current){var r,s=null===a||void 0===a||null===(r=a.current)||void 0===r?void 0:r.scrollTop;this.props.thread.setScrollDistance(s)}}},{key:"onBaseLayoutReady",value:function(){this.setState({isBaseLayoutReady:!0})}},{key:"componentDidUpdate",value:function(){var e,t,n=this;if(this.state.isBaseLayoutReady){var i,a,r,s,o=null===(i=this.threadBodyRef)||void 0===i||null===(a=i.current)||void 0===a||null===(r=a.listRef)||void 0===r||null===(s=r.current)||void 0===s?void 0:s.listWrapper;o&&this.scrollToPostion(o),this.setState({isBaseLayoutReady:!1})}null!==(e=this.props.commentPosition)&&void 0!==e&&e.postId&&!this.isPositioned&&null!==(t=this.positionRef)&&void 0!==t&&t.current&&(this.isPositioned=!0,setTimeout((function(){n.positionRef.current.scrollIntoView()}),1e3))}},{key:"componentWillUnmount",value:function(){}},{key:"scrollToPostion",value:function(e){var t;null===e||void 0===e||null===(t=e.current)||void 0===t||t.scrollTo(0,this.props.thread.scrollDistance)}},{key:"loadCommentList",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.props.thread.isCommentReady,!this.state.isCommentLoading&&i){e.next=3;break}return e.abrupt("return");case 3:return this.setState({isCommentLoading:!0}),a=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,s={id:a,page:this.props.thread.page,perPage:this.perPage,sort:this.commentDataSort?"createdAt":"-createdAt"},e.next=8,this.props.thread.loadCommentList(s);case 8:if(o=e.sent,c=o.success,l=o.msg,this.setState({isCommentLoading:!1}),!c){e.next=14;break}return e.abrupt("return");case 14:F.a.error({content:l});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onSortChange",value:function(e){this.commentDataSort=e,this.props.thread.setCommentListPage(1),this.props.commentPosition.reset(),this.loadCommentList()}},{key:"onInputClick",value:function(){this.setState({showCommentInput:!0})}},{key:"onOperClick",value:function(e){if("stick"===e&&this.updateStick(),"essence"===e&&this.updateEssence(),"poster"===e&&this.updatePoster(),"delete"===e&&this.setState({showDeletePopup:!0}),"edit"===e){var t,n,i,a;if(null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n||!n.id)return;this.props.router.push("/thread/post?id=".concat(null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.id))}"report"===e&&this.setState({showReportPopup:!0})}},{key:"onReportClick",value:function(e){if(!this.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});this.comment=e,this.setState({showReportPopup:!0})}},{key:"onReportOk",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return F.a.info({content:"\u8bf7\u9009\u62e9\u6216\u8f93\u5165\u4e3e\u62a5\u7406\u7531"}),e.abrupt("return");case 3:return n={threadId:this.props.thread.threadData.threadId,reason:t,userId:this.props.user.userInfo.id},this.comment?(n.type=2,n.postId=this.comment.id):n.type=1,e.next=7,this.props.thread.createReports(n);case 7:if(i=e.sent,a=i.success,s=i.msg,!a){e.next=14;break}return F.a.success({content:"\u64cd\u4f5c\u6210\u529f"}),this.setState({showReportPopup:!1}),e.abrupt("return",!0);case 14:F.a.error({content:s});case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onReportCancel",value:function(){this.comment=null,this.setState({showReportPopup:!1})}},{key:"setTopState",value:function(e){var t=this;this.setState({showContent:e,setTop:!this.state.setTop}),setTimeout((function(){t.setState({setTop:!t.state.setTop})}),2e3)}},{key:"updateStick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,o={id:s,isStick:!(null!==(i=this.props.thread)&&void 0!==i&&null!==(a=i.threadData)&&void 0!==a&&a.isStick)},e.next=4,this.props.thread.updateStick(o);case 4:if(c=e.sent,l=c.success,u=c.msg,!l){e.next=11;break}return this.setTopState(o.isStick),(null===(d=this.props)||void 0===d||null===(p=d.index)||void 0===p?void 0:p.refreshHomeData)&&this.props.index.refreshHomeData(),e.abrupt("return");case 11:F.a.error({content:u});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateEssence",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,c={id:o,isEssence:!(null!==(i=this.props.thread)&&void 0!==i&&null!==(a=i.threadData)&&void 0!==a&&null!==(s=a.displayTag)&&void 0!==s&&s.isEssence)},e.next=4,this.props.thread.updateEssence(c);case 4:if(l=e.sent,u=l.success,d=l.msg,this.props.thread.updateListStore(),!u){e.next=11;break}return F.a.success({content:"\u64cd\u4f5c\u6210\u529f"}),e.abrupt("return");case 11:F.a.error({content:d});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updatePoster",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,c={id:o,isPoster:!(null!==(i=this.props.thread)&&void 0!==i&&null!==(a=i.threadData)&&void 0!==a&&null!==(s=a.displayTag)&&void 0!==s&&s.isPoster)},e.next=4,this.props.thread.updatePoster(c);case 4:if(l=e.sent,u=l.success,d=l.msg,this.props.thread.updateListStore(),!u){e.next=11;break}return F.a.success({content:"\u64cd\u4f5c\u6210\u529f"}),e.abrupt("return");case 11:F.a.error({content:d});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({showDeletePopup:!1}),i=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,e.next=4,this.props.thread.delete(i);case 4:if(a=e.sent,s=a.success,o=a.msg,!s){e.next=12;break}return F.a.success({content:"\u5220\u9664\u6210\u529f\uff0c\u5373\u5c06\u8df3\u8f6c\u81f3\u9996\u9875"}),this.props.index.deleteThreadsData({id:i},this.props.site),setTimeout((function(){c.props.router.push("/")}),1e3),e.abrupt("return");case 12:F.a.error({content:o});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onBtnClick",value:function(){this.delete(),this.setState({showDeletePopup:!1})}},{key:"onPublishClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p,h=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.length>0&&void 0!==h[0]?h[0]:"",n=h.length>1&&void 0!==h[1]?h[1]:[],this.props.user.isLogin()){e.next=6;break}return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(B.a)({url:"/user/login"}),e.abrupt("return");case 6:if(t.replace(/\s/g,"")||0!==n.length){e.next=10;break}return F.a.info({content:"\u8bf7\u8f93\u5165\u5185\u5bb9"}),e.abrupt("return");case 10:if(i={val:t,imageList:n},!(a=this.props.site.webConfig)){e.next=25;break}if(c=null===a||void 0===a||null===(s=a.qcloud)||void 0===s?void 0:s.qcloudCaptcha,l=null===a||void 0===a||null===(o=a.other)||void 0===o?void 0:o.createThreadWithCaptcha,!c||!l){e.next=25;break}return e.next=18,this.props.showCaptcha();case 18:if(u=e.sent,d=u.captchaTicket,p=u.captchaRandStr,d||p){e.next=23;break}return e.abrupt("return",!1);case 23:i.captchaTicket=d,i.captchaRandStr=p;case 25:if(!this.comment){e.next=31;break}return e.next=28,this.updateComment(i);case 28:e.t0=e.sent,e.next=34;break;case 31:return e.next=33,this.createComment(i);case 33:e.t0=e.sent;case 34:return e.abrupt("return",e.t0);case 35:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createComment",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c,l,u,d,p,h,v,m,f,j,b,k,x,C,O;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.val,c=t.imageList,l=t.captchaTicket,u=void 0===l?"":l,d=t.captchaRandStr,p=void 0===d?"":d,h=null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i?void 0:i.id,v={id:h,content:o,sort:this.commentDataSort,isNoMore:null===(a=this.props)||void 0===a||null===(s=a.thread)||void 0===s?void 0:s.isNoMore,attachments:[],captchaTicket:u,captchaRandStr:p},null!==c&&void 0!==c&&c.length&&(v.attachments=c.filter((function(e){return"success"===e.status&&e.response})).map((function(e){return{id:e.response.id,type:"attachments"}}))),e.next=6,this.props.comment.createComment(v,this.props.thread);case 6:if(m=e.sent,f=m.success,j=m.msg,b=m.isApproved,k=m.redPacketAmount,!f){e.next=20;break}return b?F.a.success({content:j}):F.a.warning({content:j}),k&&k>0&&this.props.thread.setRedPacket(k),this.props.thread.updatePostCount(this.props.thread.totalCount),this.props.thread.updateListStore(),(null===(x=this.props.thread)||void 0===x||null===(C=x.threadData)||void 0===C||null===(O=C.displayTag)||void 0===O?void 0:O.isRedPack)&&this.props.thread.fetchThreadDetail(h),this.setState({showCommentInput:!1,inputValue:""}),e.abrupt("return",!0);case 20:F.a.error({content:j});case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateComment",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c,l,u,d,p,h,v,m,f;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.val,s=t.imageList,o=t.captchaTicket,c=void 0===o?"":o,l=t.captchaRandStr,u=void 0===l?"":l,this.comment){e.next=3;break}return e.abrupt("return");case 3:return d=null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i?void 0:i.id,p={id:d,postId:this.comment.id,content:a,attachments:[],captchaTicket:c,captchaRandStr:u},null!==s&&void 0!==s&&s.length&&(p.attachments=s.filter((function(e){return"success"===e.status&&e.response})).map((function(e){return{id:e.response.id,type:"attachments"}}))),e.next=8,this.props.comment.updateComment(p,this.props.thread);case 8:if(h=e.sent,v=h.success,m=h.msg,f=h.isApproved,!v){e.next=16;break}return f?F.a.success({content:m}):F.a.warning({content:m}),this.setState({showCommentInput:!1}),e.abrupt("return",!0);case 16:F.a.error({content:m});case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEditClick",value:function(e){if(!this.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});this.comment=e,this.setState({inputValue:e.content,showCommentInput:!0})}},{key:"onClose",value:function(){this.setState({showCommentInput:!1}),this.comment=null}},{key:"onLikeClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(B.a)({url:"/user/login"}),e.abrupt("return");case 4:if(!this.likedLoading){e.next=6;break}return e.abrupt("return");case 6:return this.likedLoading=!0,c=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,l={id:c,pid:null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.postId,isLiked:!(null!==(s=this.props.thread)&&void 0!==s&&null!==(o=s.threadData)&&void 0!==o&&o.isLike)},e.next=11,this.props.thread.updateLiked(l,this.props.index,this.props.user);case 11:u=e.sent,d=u.success,p=u.msg,this.likedLoading=!1,d||F.a.error({content:p});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onShareClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F.a.info({content:"\u590d\u5236\u94fe\u63a5\u6210\u529f"}),o=(null===(t=this.props.thread)||void 0===t?void 0:t.threadData)||{},c=o.title,l=void 0===c?"":c,Q()({title:l,path:"thread/".concat(null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i?void 0:i.threadId)}),u=null===(a=this.props.thread)||void 0===a||null===(s=a.threadData)||void 0===s?void 0:s.id,e.next=6,this.props.thread.shareThread(u);case 6:d=e.sent,p=d.success,h=d.msg,p||F.a.error({content:h});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onCollectionClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(B.a)({url:"/user/login"}),e.abrupt("return");case 4:if(!this.collectLoading){e.next=6;break}return e.abrupt("return");case 6:return this.collectLoading=!0,a=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,s={id:a,isFavorite:!(null!==(i=this.props.thread)&&void 0!==i&&i.isFavorite)},e.next=11,this.props.thread.updateFavorite(s);case 11:o=e.sent,c=o.success,l=o.msg,this.collectLoading=!1,c||F.a.error({content:l});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onFollowClick",value:function(){if(!this.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});var e,t,n,i;this.props.thread.threadData.userId&&(2===(null===(e=this.props.thread)||void 0===e||null===(t=e.authorInfo)||void 0===t?void 0:t.follow)||1===(null===(n=this.props.thread)||void 0===n||null===(i=n.authorInfo)||void 0===i?void 0:i.follow)?this.props.thread.cancelFollow({id:this.props.thread.threadData.userId,type:1},this.props.user):this.props.thread.postFollow(this.props.thread.threadData.userId,this.props.user))}},{key:"onPayClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(B.a)({url:"/user/login"}),e.abrupt("return");case 4:return a=this.props.thread.threadData,e.next=7,Object(Y.a)(a,null===(t=this.props.user)||void 0===t?void 0:t.userInfo);case 7:if(s=e.sent,!s.success||null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i||!i.threadId){e.next=13;break}return e.next=12,this.props.thread.fetchThreadDetail(null===(o=this.props.thread)||void 0===o||null===(c=o.threadData)||void 0===c?void 0:c.threadId);case 12:this.props.thread.updateListStore();case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onRewardClick",value:function(){if(!this.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});this.setState({showRewardPopup:!0})}},{key:"onRewardSubmit",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(isNaN(Number(t))||null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i||!i.threadId||null===(a=this.props.thread)||void 0===a||null===(s=a.threadData)||void 0===s||!s.userId){e.next=9;break}return this.setState({showRewardPopup:!1}),l={amount:Number(t),threadId:this.props.thread.threadData.threadId,payeeId:this.props.thread.threadData.userId,title:(null===(o=this.props.thread)||void 0===o||null===(c=o.threadData)||void 0===c?void 0:c.title)||"\u4e3b\u9898\u6253\u8d4f"},e.next=5,this.props.thread.rewardPay(l,this.props.user,this.props.index);case 5:u=e.sent,d=u.success,p=u.msg,d||F.a.error({content:p});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTagClick",value:function(){var e,t,n=null===(e=this.props.thread)||void 0===e||null===(t=e.threadData)||void 0===t?void 0:t.categoryId;(n||"number"===typeof n)&&this.props.index.refreshHomeData({categoryIds:[n]}),this.props.router.push("/cate/".concat(n,"/seq/0"))}},{key:"onPrivateLetter",value:function(){var e;if(!this.props.user.isLogin())return F.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(B.a)({url:"/user/login"});var t=null===(e=this.props.thread)||void 0===e?void 0:e.authorInfo,n=t.id,i=t.nickname;n&&g.a.push({url:"/message?page=chat&userId=".concat(n,"&nickname=").concat(i)})}},{key:"onUserClick",value:function(e){e&&g.a.push({url:"/user/".concat(e)})}},{key:"onLoadMoreClick",value:function(){this.props.commentPosition.page=this.props.commentPosition.page+1,this.loadCommentPositionList()}},{key:"loadCommentPositionList",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.props.commentPosition.isCommentReady,!this.state.isCommentLoading&&s){e.next=3;break}return e.abrupt("return");case 3:return this.setState({isCommentLoading:!0}),o=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,c={id:o,page:(null===(i=this.props)||void 0===i||null===(a=i.commentPosition)||void 0===a?void 0:a.page)||1,perPage:this.perPage,sort:this.commentDataSort?"createdAt":"-createdAt"},e.next=8,this.props.commentPosition.loadCommentList(c);case 8:if(l=e.sent,u=l.success,d=l.msg,this.setState({isCommentLoading:!1}),!u){e.next=14;break}return e.abrupt("return",!0);case 14:F.a.error({content:d});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderContent",value:function(){var e,t=this,n=this.props,a=n.thread,r=n.canPublish,s=a.isReady,o=a.isCommentReady,c=(a.isNoMore,a.totalCount,a.isCommentListError),l=this.props.site.webConfig,u=1===((null===a||void 0===a||null===(e=a.threadData)||void 0===e?void 0:e.isApproved)||0),d=this.props.commentPosition,p=d.isShowCommentList,h=d.isNoMore;return Object(i.jsxs)("div",{className:Ye.a.bodyLeft,children:[s&&!u&&Object(i.jsx)("div",{className:Ye.a.examinePosition}),s?Object(i.jsx)(lt,{store:a,onOperClick:function(e){return t.onOperClick(e)},onLikeClick:function(){return t.onLikeClick()},onCollectionClick:function(){return t.onCollectionClick()},onShareClick:function(){return t.onShareClick()},onRewardClick:function(){return t.onRewardClick()},onTagClick:function(){return t.onTagClick()},onPayClick:function(){return t.onPayClick()},onUserClick:function(){var e,n,i;return t.onUserClick(null===(e=t.props.thread)||void 0===e||null===(n=e.threadData)||void 0===n||null===(i=n.user)||void 0===i?void 0:i.userId)}}):Object(i.jsx)(S.a,{type:"init"}),l.setSite.siteComment[0].value&&Object(i.jsx)("div",{className:"".concat(Ye.a.bottom),children:o&&u?Object(i.jsxs)(b.Fragment,{children:[o&&p&&Object(i.jsxs)(b.Fragment,{children:[Object(i.jsx)(kt,{commentDataRef:this.commentDataRef,isPositionComment:!0,router:this.props.router,sort:function(e){return t.onSortChange(e)},replyAvatarClick:function(e,n,i){return t.replyAvatarClick(e,n,i)}}),!h&&Object(i.jsxs)("div",{className:Ye.a.showMore,onClick:function(){return t.onLoadMoreClick()},children:[Object(i.jsx)("div",{className:Ye.a.hidePercent,children:"\u5c55\u5f00\u66f4\u591a\u8bc4\u8bba"}),Object(i.jsx)(T.a,{className:Ye.a.icon,name:"RightOutlined",size:12})]})]}),Object(i.jsx)(kt,{canPublish:r,positionRef:this.positionRef,showHeader:!p,router:this.props.router,sort:function(e){return t.onSortChange(e)},onEditClick:function(e){return t.onEditClick(e)},onPublishClick:function(e,n){return t.onPublishClick(e,n)},onReportClick:function(e){return t.onReportClick(e)}})]}):u&&Object(i.jsx)(S.a,{isError:c,type:"init"})})]})}},{key:"renderRight",value:function(){var e,t,n,a,r,s,o,c=this,l=this.props.thread,u=l.isAuthorInfoError,d=l.isReady,p=1===((null===l||void 0===l||null===(e=l.threadData)||void 0===e?void 0:e.isApproved)||0),h=(null===(t=this.props.user)||void 0===t||null===(n=t.userInfo)||void 0===n?void 0:n.id)&&(null===(a=this.props.user)||void 0===a||null===(r=a.userInfo)||void 0===r?void 0:r.id)===(null===l||void 0===l||null===(s=l.threadData)||void 0===s?void 0:s.userId),v=null===l||void 0===l||null===(o=l.threadData)||void 0===o?void 0:o.isAnonymous;return Object(i.jsxs)("div",{className:"".concat(Ye.a.bodyRigth),children:[d&&!p&&Object(i.jsx)("div",{className:Ye.a.examinePosition}),!v&&Object(i.jsx)("div",{className:"".concat(Ye.a.authorInfo," detail-authorinfo"),children:null!==l&&void 0!==l&&l.authorInfo?Object(i.jsx)(Ge.a,{user:l.authorInfo,onFollowClick:function(){return c.onFollowClick()},onPrivateLetter:function(){return c.onPrivateLetter()},onPersonalPage:function(){var e,t,n;return c.onUserClick(null===(e=c.props.thread)||void 0===e||null===(t=e.threadData)||void 0===t||null===(n=t.user)||void 0===n?void 0:n.userId)},isShowBtn:!h}):Object(i.jsx)(S.a,{type:"init",isError:u})}),Object(i.jsx)("div",{className:Ye.a.recommend,children:Object(i.jsx)(it.a,{})}),Object(i.jsx)("div",{className:Ye.a.qrcode,children:Object(i.jsx)(at.a,{})}),Object(i.jsx)(We.a,{className:Ye.a.copyright})]})}},{key:"render",value:function(){var e,t,n,a,r,s,o,c,l,u,d,p,h,v,m,f,j,b,k=this,x=this.props.thread,C=x.isCommentReady,O=x.isNoMore,y=this.props.thread,D=y.isReady,w=1===((null===y||void 0===y||null===(e=y.threadData)||void 0===e?void 0:e.isApproved)||0),g=null===y||void 0===y||null===(t=y.threadData)||void 0===t?void 0:t.isAnonymous,N=(null===(n=this.props.user)||void 0===n||null===(a=n.userInfo)||void 0===a?void 0:a.id)&&(null===(r=this.props.user)||void 0===r||null===(s=r.userInfo)||void 0===s?void 0:s.id)===(null===y||void 0===y||null===(o=y.threadData)||void 0===o?void 0:o.userId);return Object(i.jsxs)("div",{children:[Object(i.jsx)(et,{showContent:null===(c=this.props.thread)||void 0===c||null===(l=c.threadData)||void 0===l?void 0:l.isStick,setTop:this.state.setTop}),Object(i.jsx)(nt,{isShow:D&&!w}),Object(i.jsx)(Qe.a,{onRefresh:function(){return k.handleOnRefresh()},onScroll:function(){return k.handleOnScroll()},noMore:O,ref:this.threadBodyRef,showRefresh:!1,right:this.renderRight(),isShowLayoutRefresh:C,ready:function(){return k.onBaseLayoutReady()},rightClassName:I()(Ye.a.positionSticky,{"is-userinfo-show":!g,"is-operate-show":!N}),className:"detail",children:this.renderContent()}),Object(i.jsx)($.a,{position:"center",visible:this.state.showCommentInput,onClose:function(){return k.onClose()},children:Object(i.jsxs)("div",{className:Ye.a.editCmment,children:[Object(i.jsx)("div",{className:Ye.a.close,onClick:function(){return k.onClose()},children:Object(i.jsx)(T.a,{size:18,name:"WrongOutlined"})}),Object(i.jsx)("div",{className:Ye.a.title,children:"\u7f16\u8f91\u8bc4\u8bba"}),Object(i.jsx)("div",{className:Ye.a.user,children:Object(i.jsx)(be.a,{name:(null===this||void 0===this||null===(u=this.comment)||void 0===u||null===(d=u.user)||void 0===d?void 0:d.nickname)||"",avatar:(null===this||void 0===this||null===(p=this.comment)||void 0===p||null===(h=p.user)||void 0===h?void 0:h.avatar)||"",time:"".concat(null===this||void 0===this||null===(v=this.comment)||void 0===v?void 0:v.updatedAt)||"",userId:null===this||void 0===this||null===(m=this.comment)||void 0===m||null===(f=m.user)||void 0===f?void 0:f.userId,platform:"pc"})}),Object(i.jsx)(Ke.a,{height:"middle",onSubmit:function(e){return k.onPublishClick(e)},initValue:this.state.inputValue,threadId:null===(j=this.props.thread)||void 0===j||null===(b=j.threadData)||void 0===b?void 0:b.userId,isAnonymous:g})]})}),Object(i.jsx)(_.a,{visible:this.state.showDeletePopup,onClose:function(){return k.setState({showDeletePopup:!1})},onBtnClick:function(){return k.delete()},type:"thread"}),Object(i.jsx)(Ze.a,{reportContent:this.reportContent,inputText:this.inputText,visible:this.state.showReportPopup,onCancel:function(){return k.onReportCancel()},onOkClick:function(e){return k.onReportOk(e)}}),Object(i.jsx)(Je,{visible:this.state.showRewardPopup,onCancel:function(){return k.setState({showRewardPopup:!1})},onOkClick:function(e){return k.onRewardSubmit(e)}})]})}}]),n}(k.a.Component))||bt)||bt)||bt)||bt)||bt)||bt)||bt,yt=Object(x.withRouter)(Object(Ee.a)(Ot)),Dt=n("QcND"),wt=n("ZCww"),gt=n("L0er"),Nt=n("J0pL"),Rt=n("Tk/S"),Pt=n("/Ugf"),It=n("lF3x"),St=(n("z/8X"),n("SRSl"));function Lt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=j()(e);if(t){var a=j()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return m()(this,n)}}var Tt=Object(C.inject)("site")(Ct=Object(C.inject)("thread")(Ct=Object(C.inject)("commentPosition")(Ct=Object(C.inject)("user")(Ct=Object(C.inject)("index")(Ct=Object(C.inject)("threadList")(Ct=Object(C.observer)(Ct=function(e){h()(n,e);var t=Lt(n);function n(e){var i;l()(this,n),(i=t.call(this,e)).updateViewCount=function(){var e=o()(r.a.mark((function e(t){var n,a,s,o,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.props.site,s=(null===a||void 0===a||null===(n=a.webConfig)||void 0===n?void 0:n.setSite)||{},o=s.openViewCount,c=Number(o),l=Number(t),e.next=6,Object(It.c)(l,0===c);case 6:(u=e.sent)&&(i.props.thread.updateViewCount(u),Object(St.d)(l,{updateType:"viewCount",updatedInfo:{viewCount:u}}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.handleWeiXinShare=o()(r.a.mark((function e(){var t,n,a,s,o,c,l,u,d,p,h,v,m,f,j,b,k,x,C,O;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e){var i=Object(Pt.a)(e);if(i)return i.length>28?"".concat(i.substr(0,28),"..."):i}var a=[];n[101]&&a.push("\u56fe\u7247"),n[103]&&a.push("\u89c6\u9891"),n[102]&&a.push("\u8bed\u97f3"),n[108]&&a.push("\u9644\u4ef6");var r=a.length>0?"".concat(a.join("/")):"\u5185\u5bb9",s=t&&t.nickname?"".concat(t.nickname):"\u533f\u540d\u7528\u6237";return"".concat(s,"\u53d1\u5e03\u7684").concat(r)},n=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,a=null;if(1!==f){for(var r=t.match(/<img[\s]+[^<>]*>|<img[\s]+[^<>]*/g)||[],s=0;s<r.length;s++)if(-1===r[s].indexOf("qq-emotion")&&(a=r[s].match(/(http|https):\/\/.*?(webp|png|jpg|jpeg)/gi))){a=a?a[0]:null;break}if(2!==f&&!a&&n[101])for(var o=n[101].body||[],c=0;c<o.length;c++)if("gif"!==o[c].extension){a=o[c].thumbUrl;break}}return!j&&!a&&e&&e.avatar&&(a=e.avatar),!a&&i&&""!==i&&(a=i),a},a=i.props,s=a.site,o=a.thread,c=s.webConfig,l=c.setSite,u=l.siteHeaderLogo,d=l.siteIntroduction,p=o.threadData,h=p.content,v=p.title,m=p.user,f=p.payType,j=p.isAnonymous,b=h.text,k=h.indexes,x=d&&""!==d?d:"\u5728\u8fd9\u91cc\uff0c\u53d1\u73b0\u66f4\u591a\u7cbe\u5f69\u5185\u5bb9",C=v&&""!==v?v:t(b,m,k),O=n(m,b,k,u),Object(Rt.a)(C,x,window.location.href,O)}catch(r){console.error("\u8bbe\u7f6e\u5206\u4eab\u9519\u8bef",r)}case 1:case"end":return e.stop()}}),e)}))),i.state={isServerError:!1,serverErrorMsg:""};var a=i.props,s=a.thread,c=a.serverThread;return(null===c||void 0===c?void 0:c.threadData)&&s.setThreadData(c.threadData),(null===c||void 0===c?void 0:c.threadUserData)&&s.setAuthorInfo(c.threadUserData),i}return d()(n,null,[{key:"getInitialProps",value:function(){var e=o()(r.a.mark((function e(t,n){var i,a,s,o,c,l,u,d,p,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=null===t||void 0===t||null===(i=t.query)||void 0===i?void 0:i.id,s={threadData:null,threadUserData:null},!a){e.next=16;break}return e.next=5,Object(O.readThreadDetail)({params:{threadId:a}},t);case 5:if(0!==(o=e.sent).code){e.next=16;break}if(s.threadData=o.data,u=n.site,d=u?u.platform:"pc",p=null===(c=s.threadData)||void 0===c||null===(l=c.user)||void 0===l?void 0:l.userId,"pc"!==d||!p){e.next=16;break}return e.next=14,Object(O.readUser)({params:{userId:p}});case 14:0===(h=e.sent).code&&(s.threadUserData=h.data);case 16:return e.abrupt("return",{serverThread:s});case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),d()(n,[{key:"componentDidUpdate",value:function(e){var t,n,i,a,r,s;(null!==(t=this.props.router)&&void 0!==t&&null!==(n=t.query)&&void 0!==n&&n.id&&this.props.router.query.id!==e.router.query.id&&(this.props.thread.reset(),this.getPageDate(this.props.router.query.id)),null!==(i=this.props.router)&&void 0!==i&&null!==(a=i.query)&&void 0!==a&&a.postId&&this.props.router.query.postId!==e.router.query.postId)&&this.getPositionComment(null===(r=this.props.router)||void 0===r||null===(s=r.query)||void 0===s?void 0:s.id,this.props.router.query.postId)}},{key:"componentDidMount",value:function(){var e=o()(r.a.mark((function e(){var t,n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.router.query,n=t.id,i=t.postId,!n){e.next=5;break}return e.next=4,this.getPageDate(n,i);case 4:this.updateViewCount(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getPageDate",value:function(){var e=o()(r.a.mark((function e(t,n){var i,a,s,o,c,l,u,d,p,h,v,m,f,j,b,k,x,C,O,y,D,w,N,R,P,I,S,L,T,E;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(i=this.props)&&void 0!==i&&null!==(a=i.thread)&&void 0!==a&&a.threadData&&(null===(s=this.props)||void 0===s||null===(o=s.thread)||void 0===o||!o.threadData.needupdate)&&this.hasMaybeCache()){e.next=23;break}return m=(null===(p=this.props.thread)||void 0===p?void 0:p.isPositionToComment)||!1,this.props.thread.reset({isPositionToComment:m}),e.next=5,this.props.thread.fetchThreadDetail(t);case 5:if(0===(f=e.sent).code){e.next=14;break}if(-4004!==f.code){e.next=10;break}return g.a.replace({url:"/404"}),e.abrupt("return");case 10:return f.code>-5e3&&f.code<-4e3&&this.setState({serverErrorMsg:f.msg}),this.setState({isServerError:!0}),-4002===f.code&&setTimeout((function(){g.a.redirect({url:"/"})}),1e3),e.abrupt("return");case 14:if(this.props.thread.threadData.needupdate=!1,1===((null===(h=this.props.thread)||void 0===h||null===(v=h.threadData)||void 0===v?void 0:v.isApproved)||0)){e.next=23;break}if(O=null===(j=this.props.user)||void 0===j||null===(b=j.userInfo)||void 0===b?void 0:b.id,y=null===(k=this.props.thread)||void 0===k||null===(x=k.threadData)||void 0===x||null===(C=x.user)||void 0===C?void 0:C.userId,O&&y&&O===y){e.next=23;break}return F.a.info({content:"\u5185\u5bb9\u6b63\u5728\u5ba1\u6838\u4e2d\uff0c\u5ba1\u6838\u901a\u8fc7\u540e\u624d\u80fd\u6b63\u5e38\u663e\u793a!"}),g.a.redirect({url:"/"}),e.abrupt("return");case 23:return this.hasMaybeCache()&&(1===((null===(D=this.props.thread)||void 0===D||null===(w=D.threadData)||void 0===w?void 0:w.isApproved)||0)||this.getThreadDataFromList(t)),Object(ce.a)()&&this.handleWeiXinShare(),e.next=27,this.getPositionComment(t,n);case 27:null!==(c=this.props)&&void 0!==c&&null!==(l=c.thread)&&void 0!==l&&l.commentList&&this.hasMaybeCache()&&!n||(this.props.thread.setCommentListPage((null===(N=this.props.commentPosition)||void 0===N?void 0:N.postsPositionPage)||1),R={id:t,page:this.props.thread.page},this.props.thread.loadCommentList(R)),null!==(u=this.props)&&void 0!==u&&null!==(d=u.thread)&&void 0!==d&&d.authorInfo&&this.hasMaybeCache()||(L=this.props.site,T=L.platform,E=null===(P=this.props.thread)||void 0===P||null===(I=P.threadData)||void 0===I||null===(S=I.user)||void 0===S?void 0:S.userId,"pc"===T&&E&&this.props.thread.fetchAuthorInfo(E)),this.props.thread.queryTipList({threadId:t,postId:n,type:2,page:1});case 30:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getThreadDataFromList",value:function(){var e=o()(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&null!==(n=this.props.threadList.findAssignThreadInLists({threadId:Number(t)}))&&void 0!==n&&n.length&&n.forEach((function(e){e.data&&(e=e.data)}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPositionComment",value:function(){var e=o()(r.a.mark((function e(t,n){var i,a,s,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n||null===(i=this.props)||void 0===i||null===(a=i.commentPosition)||void 0===a||a.reset(),!t||!n){e.next=7;break}return this.props.commentPosition.setPostId(Number(n)),s={threadId:t,postId:n,pageSize:20},e.next=6,this.props.commentPosition.fetchPositionPosts(s);case 6:this.props.commentPosition.isShowCommentList&&(o={id:t},this.props.commentPosition.loadCommentList(o));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"hasMaybeCache",value:function(){var e,t,n,i=this.props.router.query.id,a=null===(e=this.props)||void 0===e||null===(t=e.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.threadId;return i&&a&&Number(i)===a}},{key:"render",value:function(){var e,t,n,a,r,s,o,c,l,u=this.props,d=u.site,p=u.canPublish,h=d.platform,v=!0;return(null!==(e=this.props)&&void 0!==e&&null!==(t=e.thread)&&void 0!==t&&null!==(n=t.threadData)&&void 0!==n&&n.title||null!==(a=this.props)&&void 0!==a&&null!==(r=a.thread)&&void 0!==r&&null!==(s=r.threadData)&&void 0!==s&&null!==(o=s.content)&&void 0!==o&&o.text)&&(v=!1),this.state.isServerError?"h5"===h?Object(i.jsx)(gt.a,{text:this.state.serverErrorMsg}):Object(i.jsx)(wt.a,{text:this.state.serverErrorMsg}):Object(i.jsx)(Nt.a,{h5:Object(i.jsx)(He,{canPublish:p}),pc:Object(i.jsx)(yt,{canPublish:p}),title:(null===(c=this.props)||void 0===c||null===(l=c.thread)||void 0===l?void 0:l.title)||"",showSiteName:v})}}]),n}(k.a.Component))||Ct)||Ct)||Ct)||Ct)||Ct)||Ct)||Ct;t.default=Object(Dt.a)(Object(x.withRouter)(Tt))},ZCww:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("nKUr"),a=n("q1tI"),r=n("6csX"),s=n("5f2u"),o=n.n(s),c=n("z8Av"),l=n("wXCO");function u(e){var t=Object(a.useState)(e.text||"\u670d\u52a1\u5668\u9519\u8bef SERVER ERROR")[0];return Object(i.jsxs)("div",{className:r.a.page,children:[Object(i.jsx)(c.a,{}),Object(i.jsxs)("div",{className:r.a.body,children:[Object(i.jsx)("img",{alt:"\u56fe\u7247",className:r.a.icon,src:"/dzq-img/error.png"}),Object(i.jsx)("span",{className:r.a.text,children:t}),Object(i.jsx)(o.a,{onClick:function(){window.location.reload()},className:r.a.button,type:"primary",children:"\u70b9\u6211\u5237\u65b0"})]}),Object(i.jsx)("div",{className:r.a.footer,children:Object(i.jsx)(l.a,{})})]})}},c7hV:function(e,t,n){"use strict";var i=n("nKUr"),a=n("q1tI"),r=n("MCNy"),s=n.n(r),o=n("k8W2"),c=n.n(o),l=n("5f2u"),u=n.n(l),d=n("ZS9c"),p=n("TSYQ"),h=n.n(p);t.a=function(e){var t=e.visible,n=e.onSubmit,r=e.onClose,o=e.onOperClick,l=e.permissions,p=void 0===l?{}:l,v=e.statuses,m=void 0===v?{}:v,f=p.canEdit,j=p.canDelete,b=p.canEssence,k=p.canStick,x=p.canShare,C=p.canWxShare,O=p.canCollect,y=p.isAdmini,D=m.isEssence,w=m.isStick,g=m.isCollect,N=Object(a.useState)(D),R=N[0],P=N[1],I=Object(a.useState)(w),S=I[0],L=I[1],T=Object(a.useState)(g),E=T[0],A=T[1],M=Object(a.useMemo)((function(){return 1+f+j+b+k+x+O}),[f,j,b,k,x,O]);return Object(a.useEffect)((function(){P(D)}),[D]),Object(a.useEffect)((function(){L(w)}),[w]),Object(a.useEffect)((function(){A(g)}),[g]),Object(i.jsx)(c.a,{position:"bottom",visible:t,onClose:r,children:Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{className:d.a.container,children:Object(i.jsxs)("div",{className:h()(d.a.more,M<5&&d.a.flex),children:[f&&Object(i.jsxs)("div",{className:d.a.moreItem,onClick:function(){return o("edit")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"RedactOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u7f16\u8f91"})]}),j&&Object(i.jsxs)("div",{className:d.a.moreItem,onClick:function(){return o("delete")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"DeleteOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u5220\u9664"})]}),b&&Object(i.jsxs)("div",{className:h()(d.a.moreItem,R&&d.a.actived),onClick:function(){return o("essence")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"HotBigOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u7cbe\u534e"})]}),k&&Object(i.jsxs)("div",{className:h()(d.a.moreItem,S&&d.a.actived),onClick:function(){return o("stick")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"TopOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u7f6e\u9876"})]}),O&&Object(i.jsxs)("div",{className:h()(d.a.moreItem,E&&d.a.actived),onClick:function(){return o("collect")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"CollectFunOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u6536\u85cf"})]}),x&&Object(i.jsxs)("div",{className:d.a.moreItem,onClick:function(){return o("post")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"PictureOutlinedBig",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u751f\u6210\u6d77\u62a5"})]}),x&&Object(i.jsxs)("div",{className:d.a.moreItem,onClick:function(){return o("copylink")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"PaperClipOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u590d\u5236\u94fe\u63a5"})]}),C&&Object(i.jsxs)("div",{className:d.a.moreItem,onClick:function(){return o("wxshare")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"WeChatOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u5fae\u4fe1\u5206\u4eab"})]}),!y&&Object(i.jsxs)("div",{className:d.a.moreItem,onClick:function(){return o("report")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"WarnOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u4e3e\u62a5"})]})]})}),Object(i.jsx)("div",{className:d.a.button,children:Object(i.jsx)(u.a,{full:!0,onClick:n,className:d.a.cancel,type:"default",children:"\u53d6\u6d88"})})]})})}},tuZy:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/thread/[id]",function(){return n("TP+V")}])},woGs:function(e,t,n){"use strict";n("2B1R"),n("qePV");var i=n("nKUr"),a=n("o0o1"),r=n.n(a),s=(n("ls82"),n("yXPU")),o=n.n(s),c=n("q1tI"),l=n("wdT/"),u=n.n(l),d=n("k8W2"),p=n.n(d),h=n("5f2u"),v=n.n(h),m=n("7O/2"),f=n.n(m),j=n("BGqZ"),b=n.n(j),k=n("qtPy");t.a=function(e){var t=e.visible,n=e.onOkClick,a=e.onCancel,s=e.inputText,l=e.reportContent,d=void 0===l?[]:l,h=Object(c.useState)(""),m=h[0],j=h[1],x=Object(c.useState)(!1),C=x[0],O=x[1],y=function(){var e=o()(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(m.length>450)){e.next=3;break}return u.a.error({content:"\u4e3e\u62a5\u5185\u5bb9\u4e0d\u80fd\u5927\u4e8e450\u4e2a\u5b57\u7b26"}),e.abrupt("return");case 3:if("function"!==typeof n){e.next=14;break}return e.prev=4,e.next=7,n(m);case 7:e.sent&&j(""),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(){return e.apply(this,arguments)}}();return Object(i.jsx)(p.a,{position:"bottom",visible:t,onClose:a,children:Object(i.jsxs)("div",{className:k.a.container,children:[Object(i.jsxs)("div",{className:k.a.header,children:[Object(i.jsx)("div",{className:k.a.title,children:"\u4e3e\u62a5"}),Object(i.jsx)("div",{className:k.a.reason,children:"\u8bf7\u9009\u62e9\u4e3e\u62a5\u7406\u7531"})]}),Object(i.jsxs)("div",{className:k.a.body,children:[Object(i.jsxs)(b.a.Group,{defaultValue:"5",onChange:function(e){return function(e){"other"===e?(O(!0),j("")):(O(!1),j(d[Number(e)]))}(e)},children:[d.map((function(e,t){return Object(i.jsxs)("div",{className:k.a.reportTitle,children:[Object(i.jsx)("div",{className:k.a.content,children:e}),Object(i.jsx)(b.a,{name:"".concat(t)})]},t)})),Object(i.jsxs)("div",{className:k.a.reportTitle,children:[Object(i.jsx)("div",{className:k.a.content,children:"\u5176\u4ed6"}),Object(i.jsx)(b.a,{name:"other"})]})]}),C?Object(i.jsx)("div",{className:k.a.textarea,children:Object(i.jsx)(f.a,{className:k.a.input,rows:5,showLimit:!0,value:m,onChange:function(e){return j(e.target.value)},placeholder:s})}):""]}),Object(i.jsxs)("div",{className:k.a.button,children:[Object(i.jsx)(v.a,{onClick:a,className:k.a.cancel,children:"\u53d6\u6d88"}),Object(i.jsx)(v.a,{onClick:y,className:k.a.ok,type:"primary",children:"\u786e\u5b9a"})]})]})})}}},[["tuZy",0,1,5,4,6,8,3,2]]]);